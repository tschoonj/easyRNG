<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>easyRNG: Examples</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">easyRNG
   &#160;<span id="projectnumber">1.2</span>
   </div>
   <div id="projectbrief">BSD licensed random number generators for C and Fortran</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Examples </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#test1">Test 1: random number generator C API validation</a></li>
<li class="level1"><a href="#test2">Test 2: random number generator C API performance test</a></li>
<li class="level1"><a href="#test3">Test 3: random number distributions C API accuracy test</a></li>
<li class="level1"><a href="#test4">Test 4: random number generator Fortran API validation</a></li>
<li class="level1"><a href="#test5">Test 5: random number generator Fortran API performance test</a></li>
<li class="level1"><a href="#test6">Test 6: random number distributions Fortran API accuracy test</a></li>
</ul>
</div>
<div class="textblock"><p>This page contains the code of the tests I have included to validate the program. The code should be quite straightforward to understand. Comments have been added where deemed useful.</p>
<h1><a class="anchor" id="test1"></a>
Test 1: random number generator C API validation</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="easy__rng_8h.html">easy_rng.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;assert.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line">    <span class="keywordtype">int</span> i;</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="easy__rng_8h.html#structeasy__rng__type">easy_rng_type</a> **all_types = <a class="code" href="easy__rng_8h.html#a48ab27e3436e334bacfe4552c77a8293">easy_rng_types_setup</a>();</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;All available RNGs:\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0 ; all_types[i] != NULL ; i++) {</div>
<div class="line">        fprintf(stdout, <span class="stringliteral">&quot;\tname %i: %s\n&quot;</span>, i, all_types[i]-&gt;name);</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="easy__rng_8h.html#a5662391114b11e8e4941bb6fe2afcc8c">easy_rng</a> *rng = <a class="code" href="easy__rng_8h.html#a34837a567a02ed025cc5230cafcfa30a">easy_rng_alloc</a>(all_types[i]);</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="easy__rng_8h.html#a4cde3fe49fdd3a78826ffcc3a440c5b6">easy_rng_set</a>(rng, 1234);</div>
<div class="line"> </div>
<div class="line">        fprintf(stdout, <span class="stringliteral">&quot;get: %lu\n&quot;</span>, <a class="code" href="easy__rng_8h.html#a6df8544bca640da8fc342b835420372c">easy_rng_get</a>(rng));</div>
<div class="line">        fprintf(stdout, <span class="stringliteral">&quot;uniform: %g\n&quot;</span>, <a class="code" href="easy__rng_8h.html#a1d59580b57d8241e420d989afc3cf226">easy_rng_uniform</a>(rng));</div>
<div class="line">        fprintf(stdout, <span class="stringliteral">&quot;uniform_pos: %g\n&quot;</span>, <a class="code" href="easy__rng_8h.html#abb81d00f216d1c72cc7a4faee4839ac9">easy_rng_uniform_pos</a>(rng));</div>
<div class="line">        fprintf(stdout, <span class="stringliteral">&quot;uniform_int: %lu\n&quot;</span>, <a class="code" href="easy__rng_8h.html#a20307b97d36836c046d57794ee241174">easy_rng_uniform_int</a>(rng, 10));</div>
<div class="line">        fprintf(stdout, <span class="stringliteral">&quot;name: %s\n&quot;</span>, <a class="code" href="easy__rng_8h.html#a5283493f3e6510dc16ea6243a3064cc8">easy_rng_name</a>(rng));</div>
<div class="line">        fprintf(stdout, <span class="stringliteral">&quot;min: %lu\n&quot;</span>, <a class="code" href="easy__rng_8h.html#ab7ebef8f2b34c0e623a67558ecc7aff8">easy_rng_min</a>(rng));</div>
<div class="line">        fprintf(stdout, <span class="stringliteral">&quot;max: %lu\n&quot;</span>, <a class="code" href="easy__rng_8h.html#ae10e10fb6573d977a7b7fdd89000ce02">easy_rng_max</a>(rng));</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// check cloning</span></div>
<div class="line">        <a class="code" href="easy__rng_8h.html#a5662391114b11e8e4941bb6fe2afcc8c">easy_rng</a> *rng_clone = <a class="code" href="easy__rng_8h.html#a5721c3419d7f703d74877df274d59a5d">easy_rng_clone</a>(rng);</div>
<div class="line">        assert(<a class="code" href="easy__rng_8h.html#a42e237e12705f24d1bc9185dd85da87a">easy_rng_equal</a>(rng, rng_clone));</div>
<div class="line">        <a class="code" href="easy__rng_8h.html#a6df8544bca640da8fc342b835420372c">easy_rng_get</a>(rng_clone);</div>
<div class="line">        assert(!<a class="code" href="easy__rng_8h.html#a42e237e12705f24d1bc9185dd85da87a">easy_rng_equal</a>(rng, rng_clone));</div>
<div class="line">        <a class="code" href="easy__rng_8h.html#a19d630d55113cfac076a582a6e4863ba">easy_rng_free</a>(rng_clone);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// check writing state to file and reading it back in</span></div>
<div class="line">        FILE *file;</div>
<div class="line">        <span class="keywordflow">if</span> ((file = fopen(<span class="stringliteral">&quot;test.txt&quot;</span>, <span class="stringliteral">&quot;wb&quot;</span>)) == NULL) {</div>
<div class="line">            <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
<div class="line">        <a class="code" href="easy__rng_8h.html#a92de1f25f208a2348302558c91269def">easy_rng_fwrite</a>(file, rng);</div>
<div class="line">        fclose(file);</div>
<div class="line"> </div>
<div class="line">        rng_clone = <a class="code" href="easy__rng_8h.html#a34837a567a02ed025cc5230cafcfa30a">easy_rng_alloc</a>(all_types[i]);</div>
<div class="line">        <span class="keywordflow">if</span> ((file = fopen(<span class="stringliteral">&quot;test.txt&quot;</span>, <span class="stringliteral">&quot;rb&quot;</span>)) == NULL) {</div>
<div class="line">            <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
<div class="line">        <a class="code" href="easy__rng_8h.html#a31a7405b674cffe3dacd0f044dddc3c1">easy_rng_fread</a>(file, rng_clone);</div>
<div class="line">        fclose(file);</div>
<div class="line">        assert(<a class="code" href="easy__rng_8h.html#a42e237e12705f24d1bc9185dd85da87a">easy_rng_equal</a>(rng, rng_clone));</div>
<div class="line">        unlink(<span class="stringliteral">&quot;test.txt&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="easy__rng_8h.html#a19d630d55113cfac076a582a6e4863ba">easy_rng_free</a>(rng);</div>
<div class="line">        <a class="code" href="easy__rng_8h.html#a19d630d55113cfac076a582a6e4863ba">easy_rng_free</a>(rng_clone);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --> <h1><a class="anchor" id="test2"></a>
Test 2: random number generator C API performance test</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;gsl/gsl_rng.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="easy__rng_8h.html">easy_rng.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;time.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef NRUNS</span></div>
<div class="line"><span class="preprocessor">#define NRUNS 10000000</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> run_test(<span class="keyword">const</span> gsl_rng_type *gtype, <span class="keyword">const</span> <a class="code" href="easy__rng_8h.html#structeasy__rng__type">easy_rng_type</a> *etype) {</div>
<div class="line">    gsl_rng *grng = gsl_rng_alloc(gtype);</div>
<div class="line">    <a class="code" href="easy__rng_8h.html#a5662391114b11e8e4941bb6fe2afcc8c">easy_rng</a> *erng = <a class="code" href="easy__rng_8h.html#a34837a567a02ed025cc5230cafcfa30a">easy_rng_alloc</a>(etype);</div>
<div class="line">    </div>
<div class="line">    clock_t gstart, gend;</div>
<div class="line">    clock_t estart, eend;</div>
<div class="line">    <span class="keywordtype">int</span> i;</div>
<div class="line"> </div>
<div class="line">    gstart = clock();</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0 ; i &lt; NRUNS ; i++)</div>
<div class="line">        gsl_rng_get(grng);</div>
<div class="line"> </div>
<div class="line">    gend = clock();</div>
<div class="line"> </div>
<div class="line">    estart = clock();</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0 ; i &lt; NRUNS ; i++)</div>
<div class="line">        <a class="code" href="easy__rng_8h.html#a6df8544bca640da8fc342b835420372c">easy_rng_get</a>(erng);</div>
<div class="line"> </div>
<div class="line">    eend = clock();</div>
<div class="line"> </div>
<div class="line">    gsl_rng_free(grng);</div>
<div class="line">    <a class="code" href="easy__rng_8h.html#a19d630d55113cfac076a582a6e4863ba">easy_rng_free</a>(erng);</div>
<div class="line">    </div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;Comparing easyRNG&#39;s %s with GSL&#39;s %s\n&quot;</span>, etype-&gt;<a class="code" href="easy__rng_8h.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, gtype-&gt;name);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;easyRNG %g\n&quot;</span>, ((<span class="keywordtype">double</span>) (eend - estart))/CLOCKS_PER_SEC);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;GSL %g\n&quot;</span>, ((<span class="keywordtype">double</span>) (gend - gstart))/CLOCKS_PER_SEC);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line"> </div>
<div class="line">    run_test(gsl_rng_mt19937, <a class="code" href="easy__rng_8h.html#a03a2111e5941ce6a20a210cf6017c13d">easy_rng_mt19937</a>);</div>
<div class="line">    run_test(gsl_rng_ranlux, <a class="code" href="easy__rng_8h.html#a9c686db435b2ca790404ffa0731ce324">easy_rng_ranlux24</a>);</div>
<div class="line">    run_test(gsl_rng_ranlux389, <a class="code" href="easy__rng_8h.html#a2618c95894efe0d6b874ad37e7853a0e">easy_rng_ranlux48</a>);</div>
<div class="line">    run_test(gsl_rng_minstd, <a class="code" href="easy__rng_8h.html#a36c2cefe628eb42943d5d44ef41c4c53">easy_rng_minstd_rand0</a>);</div>
<div class="line">    run_test(gsl_rng_fishman20, <a class="code" href="easy__rng_8h.html#a7982b751eb13a826381c606b222efeaa">easy_rng_minstd_rand</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
</div><!-- fragment --> <h1><a class="anchor" id="test3"></a>
Test 3: random number distributions C API accuracy test</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="easy__randist_8h.html">easy_randist.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;assert.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;time.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define NSAMPLES 10000000</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test_uniform(<a class="code" href="easy__rng_8h.html#a5662391114b11e8e4941bb6fe2afcc8c">easy_rng</a> *rng) {</div>
<div class="line">    <span class="keywordtype">int</span> i;</div>
<div class="line">    <span class="keywordtype">double</span> mean = 0.0, M2 = 0.0;</div>
<div class="line"> </div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;Testing easy_rng_uniform\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0 ; i &lt; NSAMPLES ; i++) {</div>
<div class="line">        <span class="keywordtype">double</span> val = <a class="code" href="easy__rng_8h.html#a1d59580b57d8241e420d989afc3cf226">easy_rng_uniform</a>(rng);</div>
<div class="line">        <span class="keywordtype">double</span> delta = val - mean;</div>
<div class="line">        mean += delta/(i + 1);</div>
<div class="line">        M2 += delta * (val - mean);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">double</span> stddev = sqrt(M2/NSAMPLES);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tmean: %g\n&quot;</span>, mean);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tstddev: %g\n&quot;</span>, stddev);</div>
<div class="line">    assert(fabs(mean - 0.5) &lt; 1E-3);</div>
<div class="line">    assert(fabs(stddev - sqrt(1.0/12.0)) &lt; 1E-3);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test_uniform_pos(<a class="code" href="easy__rng_8h.html#a5662391114b11e8e4941bb6fe2afcc8c">easy_rng</a> *rng) {</div>
<div class="line">    <span class="keywordtype">int</span> i;</div>
<div class="line">    <span class="keywordtype">double</span> mean = 0.0, M2 = 0.0;</div>
<div class="line"> </div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;Testing easy_rng_uniform_pos\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0 ; i &lt; NSAMPLES ; i++) {</div>
<div class="line">        <span class="keywordtype">double</span> val = <a class="code" href="easy__rng_8h.html#abb81d00f216d1c72cc7a4faee4839ac9">easy_rng_uniform_pos</a>(rng);</div>
<div class="line">        <span class="keywordtype">double</span> delta = val - mean;</div>
<div class="line">        mean += delta/(i + 1);</div>
<div class="line">        M2 += delta * (val - mean);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">double</span> stddev = sqrt(M2/NSAMPLES);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tmean: %g\n&quot;</span>, mean);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tstddev: %g\n&quot;</span>, stddev);</div>
<div class="line">    assert(fabs(mean - 0.5) &lt; 1E-3);</div>
<div class="line">    assert(fabs(stddev - sqrt(1.0/12.0)) &lt; 1E-3);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test_uniform_int(<a class="code" href="easy__rng_8h.html#a5662391114b11e8e4941bb6fe2afcc8c">easy_rng</a> *rng) {</div>
<div class="line">    <span class="keywordtype">int</span> i;</div>
<div class="line">    <span class="keywordtype">double</span> mean = 0.0, M2 = 0.0;</div>
<div class="line"> </div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;Testing easy_rng_uniform_int\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0 ; i &lt; NSAMPLES ; i++) {</div>
<div class="line">        <span class="keywordtype">double</span> val = (double) <a class="code" href="easy__rng_8h.html#a20307b97d36836c046d57794ee241174">easy_rng_uniform_int</a>(rng, 10000);</div>
<div class="line">        <span class="keywordtype">double</span> delta = val - mean;</div>
<div class="line">        mean += delta/(i + 1);</div>
<div class="line">        M2 += delta * (val - mean);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">double</span> stddev = sqrt(M2/NSAMPLES);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tmean: %g\n&quot;</span>, mean);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tstddev: %g\n&quot;</span>, stddev);</div>
<div class="line">    assert(fabs(mean - 5000) &lt; 10);</div>
<div class="line">    assert(fabs(stddev - sqrt(10000.0 * 10000.0/12.0)) &lt; 10);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test_gaussian(<a class="code" href="easy__rng_8h.html#a5662391114b11e8e4941bb6fe2afcc8c">easy_rng</a> *rng) {</div>
<div class="line">    <span class="keywordtype">int</span> i;</div>
<div class="line">    <span class="keywordtype">double</span> mean = 0.0, M2 = 0.0;</div>
<div class="line"> </div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;Testing easy_ran_gaussian\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0 ; i &lt; NSAMPLES ; i++) {</div>
<div class="line">        <span class="keywordtype">double</span> val = <a class="code" href="easy__randist_8h.html#aa73ac6dbe5840c804b3419926ee72641">easy_ran_gaussian</a>(rng, 5.0);</div>
<div class="line">        <span class="keywordtype">double</span> delta = val - mean;</div>
<div class="line">        mean += delta/(i + 1);</div>
<div class="line">        M2 += delta * (val - mean);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">double</span> stddev = sqrt(M2/NSAMPLES);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tmean: %g\n&quot;</span>, mean);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tstddev: %g\n&quot;</span>, stddev);</div>
<div class="line">    assert(fabs(mean - 0.0) &lt; 1E-2);</div>
<div class="line">    assert(fabs(stddev - 5.0) &lt; 1E-2);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test_ugaussian(<a class="code" href="easy__rng_8h.html#a5662391114b11e8e4941bb6fe2afcc8c">easy_rng</a> *rng) {</div>
<div class="line">    <span class="keywordtype">int</span> i;</div>
<div class="line">    <span class="keywordtype">double</span> mean = 0.0, M2 = 0.0;</div>
<div class="line"> </div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;Testing easy_ran_ugaussian\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0 ; i &lt; NSAMPLES ; i++) {</div>
<div class="line">        <span class="keywordtype">double</span> val = <a class="code" href="easy__randist_8h.html#a8ac93416e4da2d0429ac109e6cc234e8">easy_ran_ugaussian</a>(rng);</div>
<div class="line">        <span class="keywordtype">double</span> delta = val - mean;</div>
<div class="line">        mean += delta/(i + 1);</div>
<div class="line">        M2 += delta * (val - mean);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">double</span> stddev = sqrt(M2/NSAMPLES);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tmean: %g\n&quot;</span>, mean);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tstddev: %g\n&quot;</span>, stddev);</div>
<div class="line">    assert(fabs(mean - 0.0) &lt; 1E-2);</div>
<div class="line">    assert(fabs(stddev - 1.0) &lt; 1E-2);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test_exponential(<a class="code" href="easy__rng_8h.html#a5662391114b11e8e4941bb6fe2afcc8c">easy_rng</a> *rng) {</div>
<div class="line">    <span class="keywordtype">int</span> i;</div>
<div class="line">    <span class="keywordtype">double</span> mean = 0.0, M2 = 0.0;</div>
<div class="line">    <span class="keywordtype">double</span> mu = 5.1047E-05;</div>
<div class="line"> </div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;Testing easy_ran_exponential\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0 ; i &lt; NSAMPLES ; i++) {</div>
<div class="line">        <span class="keywordtype">double</span> val = <a class="code" href="easy__randist_8h.html#aa2ddd4ffca96f5a5700c700a8091fc6d">easy_ran_exponential</a>(rng, mu);</div>
<div class="line">        <span class="keywordtype">double</span> delta = val - mean;</div>
<div class="line">        mean += delta/(i + 1);</div>
<div class="line">        M2 += delta * (val - mean);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">double</span> stddev = sqrt(M2/NSAMPLES);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tmean: %g\n&quot;</span>, mean);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tstddev: %g\n&quot;</span>, stddev);</div>
<div class="line">    assert(fabs(mean - mu)/mean &lt; 1E-2);</div>
<div class="line">    assert(fabs(stddev - mu)/mean &lt; 1E-2);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test_gamma(<a class="code" href="easy__rng_8h.html#a5662391114b11e8e4941bb6fe2afcc8c">easy_rng</a> *rng) {</div>
<div class="line">    <span class="keywordtype">int</span> i;</div>
<div class="line">    <span class="keywordtype">double</span> mean = 0.0, M2 = 0.0;</div>
<div class="line"> </div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;Testing easy_ran_gamma\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0 ; i &lt; NSAMPLES ; i++) {</div>
<div class="line">        <span class="keywordtype">double</span> val = <a class="code" href="easy__randist_8h.html#aa58eb8b44c683e0852e406bf0e7abcc1">easy_ran_gamma</a>(rng, 10.0, 5.0);</div>
<div class="line">        <span class="keywordtype">double</span> delta = val - mean;</div>
<div class="line">        mean += delta/(i + 1);</div>
<div class="line">        M2 += delta * (val - mean);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">double</span> stddev = sqrt(M2/NSAMPLES);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tmean: %g\n&quot;</span>, mean);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tstddev: %g\n&quot;</span>, stddev);</div>
<div class="line">    assert(fabs(mean - 50.0) &lt; 1E-1);</div>
<div class="line">    assert(fabs(stddev - sqrt(10.0 * 5.0 * 5.0))/sqrt(10.0 * 5.0 * 5.0) &lt; 1E-2);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test_flat(<a class="code" href="easy__rng_8h.html#a5662391114b11e8e4941bb6fe2afcc8c">easy_rng</a> *rng) {</div>
<div class="line">    <span class="keywordtype">int</span> i;</div>
<div class="line">    <span class="keywordtype">double</span> mean = 0.0, M2 = 0.0;</div>
<div class="line"> </div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;Testing easy_ran_flat\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0 ; i &lt; NSAMPLES ; i++) {</div>
<div class="line">        <span class="keywordtype">double</span> val = <a class="code" href="easy__randist_8h.html#a04c98539c263989a99dae4457e6ac361">easy_ran_flat</a>(rng, 95.0, 458.0);</div>
<div class="line">        <span class="keywordtype">double</span> delta = val - mean;</div>
<div class="line">        mean += delta/(i + 1);</div>
<div class="line">        M2 += delta * (val - mean);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">double</span> stddev = sqrt(M2/NSAMPLES);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tmean: %g\n&quot;</span>, mean);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tstddev: %g\n&quot;</span>, stddev);</div>
<div class="line">    assert(fabs(mean - (458.0 + 95.0)/2.0) &lt; 1);</div>
<div class="line">    assert(fabs(stddev - sqrt(1/12.0) * (458.0 - 95.0)) &lt; 1);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test_lognormal(<a class="code" href="easy__rng_8h.html#a5662391114b11e8e4941bb6fe2afcc8c">easy_rng</a> *rng) {</div>
<div class="line">    <span class="keywordtype">int</span> i;</div>
<div class="line">    <span class="keywordtype">double</span> mean = 0.0, M2 = 0.0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> zeta = 0.5, sigma = 0.2;</div>
<div class="line"> </div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;Testing easy_ran_lognormal\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0 ; i &lt; NSAMPLES ; i++) {</div>
<div class="line">        <span class="keywordtype">double</span> val = <a class="code" href="easy__randist_8h.html#acff3c5fc0e1788a0e0f312b11614cd08">easy_ran_lognormal</a>(rng, zeta, sigma);</div>
<div class="line">        <span class="keywordtype">double</span> delta = val - mean;</div>
<div class="line">        mean += delta/(i + 1);</div>
<div class="line">        M2 += delta * (val - mean);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">double</span> stddev = sqrt(M2/NSAMPLES);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tmean: %g\n&quot;</span>, mean);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tstddev: %g\n&quot;</span>, stddev);</div>
<div class="line">    assert(fabs(mean - exp(zeta + sigma * sigma / 2.0)) &lt; 1E-2);</div>
<div class="line">    assert(fabs(stddev - sqrt((exp(sigma * sigma) - 1.0) * exp(2.0 * zeta + sigma * sigma) )) &lt; 1.0E-2);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test_chisq(<a class="code" href="easy__rng_8h.html#a5662391114b11e8e4941bb6fe2afcc8c">easy_rng</a> *rng) {</div>
<div class="line">    <span class="keywordtype">int</span> i;</div>
<div class="line">    <span class="keywordtype">double</span> mean = 0.0, M2 = 0.0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> nu = 10.0;</div>
<div class="line"> </div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;Testing easy_ran_chisq\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0 ; i &lt; NSAMPLES ; i++) {</div>
<div class="line">        <span class="keywordtype">double</span> val = <a class="code" href="easy__randist_8h.html#ae5338d2afbcfbd97e6a130d485c2fc1b">easy_ran_chisq</a>(rng, nu);</div>
<div class="line">        <span class="keywordtype">double</span> delta = val - mean;</div>
<div class="line">        mean += delta/(i + 1);</div>
<div class="line">        M2 += delta * (val - mean);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">double</span> stddev = sqrt(M2/NSAMPLES);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tmean: %g\n&quot;</span>, mean);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tstddev: %g\n&quot;</span>, stddev);</div>
<div class="line">    assert(fabs(mean - nu) &lt; 1E-2);</div>
<div class="line">    assert(fabs(stddev - sqrt(2.0 * nu)) &lt; 1.0E-2);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">double</span> fdist_stddev(<span class="keywordtype">double</span> nu1, <span class="keywordtype">double</span> nu2) {</div>
<div class="line">    <span class="keywordflow">return</span> sqrt( 2.0 * nu2 * nu2 * (nu1 + nu2 - 2.0) / nu1 / (nu2 - 2.0) / (nu2 -2.0) / (nu2 - 4.0));</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test_fdist(<a class="code" href="easy__rng_8h.html#a5662391114b11e8e4941bb6fe2afcc8c">easy_rng</a> *rng) {</div>
<div class="line">    <span class="keywordtype">int</span> i;</div>
<div class="line">    <span class="keywordtype">double</span> mean = 0.0, M2 = 0.0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> nu1 = 10.0, nu2 = 5.0;</div>
<div class="line"> </div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;Testing easy_ran_fdist\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0 ; i &lt; NSAMPLES ; i++) {</div>
<div class="line">        <span class="keywordtype">double</span> val = <a class="code" href="easy__randist_8h.html#a8e9aa28448987c10b9c11aa9b802a39b">easy_ran_fdist</a>(rng, nu1, nu2);</div>
<div class="line">        <span class="keywordtype">double</span> delta = val - mean;</div>
<div class="line">        mean += delta/(i + 1);</div>
<div class="line">        M2 += delta * (val - mean);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">double</span> stddev = sqrt(M2/NSAMPLES);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tmean: %g\n&quot;</span>, mean);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tstddev: %g\n&quot;</span>, stddev);</div>
<div class="line">    <span class="keywordtype">double</span> real_stddev = fdist_stddev(nu1, nu2);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\treal stddev: %g\n&quot;</span>, real_stddev);</div>
<div class="line">    assert(fabs(mean - nu2/(nu2 - 2)) &lt; 1E-2);</div>
<div class="line">    assert(fabs(stddev - real_stddev) &lt; 5.0E-1);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test_tdist(<a class="code" href="easy__rng_8h.html#a5662391114b11e8e4941bb6fe2afcc8c">easy_rng</a> *rng) {</div>
<div class="line">    <span class="keywordtype">int</span> i;</div>
<div class="line">    <span class="keywordtype">double</span> mean = 0.0, M2 = 0.0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> nu = 10.0;</div>
<div class="line"> </div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;Testing easy_ran_tdist\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0 ; i &lt; NSAMPLES ; i++) {</div>
<div class="line">        <span class="keywordtype">double</span> val = <a class="code" href="easy__randist_8h.html#a8dda25bf957f749bf12974701984529e">easy_ran_tdist</a>(rng, nu);</div>
<div class="line">        <span class="keywordtype">double</span> delta = val - mean;</div>
<div class="line">        mean += delta/(i + 1);</div>
<div class="line">        M2 += delta * (val - mean);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">double</span> stddev = sqrt(M2/NSAMPLES);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tmean: %g\n&quot;</span>, mean);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tstddev: %g\n&quot;</span>, stddev);</div>
<div class="line">    assert(fabs(mean - 0.0) &lt; 1E-2);</div>
<div class="line">    assert(fabs(stddev - sqrt(nu/(nu - 2.0))) &lt; 1E-2);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">double</span> weibull_mean(<span class="keywordtype">double</span> a, <span class="keywordtype">double</span> b) {</div>
<div class="line">    <span class="keywordflow">return</span> a * tgamma(1.0 + 1.0/b);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">double</span> weibull_stddev(<span class="keywordtype">double</span> a, <span class="keywordtype">double</span> b) {</div>
<div class="line">    <span class="keywordflow">return</span> a * sqrt(tgamma(1.0 + 2.0/b) - tgamma(1.0 + 1.0/b) * tgamma(1.0 + 1.0/b));</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test_weibull(<a class="code" href="easy__rng_8h.html#a5662391114b11e8e4941bb6fe2afcc8c">easy_rng</a> *rng) {</div>
<div class="line">    <span class="keywordtype">int</span> i;</div>
<div class="line">    <span class="keywordtype">double</span> mean = 0.0, M2 = 0.0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> a = 2.0, b = 5.0;</div>
<div class="line"> </div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;Testing easy_ran_weibull\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0 ; i &lt; NSAMPLES ; i++) {</div>
<div class="line">        <span class="keywordtype">double</span> val = <a class="code" href="easy__randist_8h.html#a682f3f28ebcc64d3859c00d786b3cdf7">easy_ran_weibull</a>(rng, a, b);</div>
<div class="line">        <span class="keywordtype">double</span> delta = val - mean;</div>
<div class="line">        mean += delta/(i + 1);</div>
<div class="line">        M2 += delta * (val - mean);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">double</span> stddev = sqrt(M2/NSAMPLES);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tmean: %g\n&quot;</span>, mean);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tstddev: %g\n&quot;</span>, stddev);</div>
<div class="line">    <span class="keywordtype">double</span> real_mean = weibull_mean(a, b);</div>
<div class="line">    <span class="keywordtype">double</span> real_stddev = weibull_stddev(a, b);</div>
<div class="line">    <span class="comment">//fprintf(stdout, &quot;\treal mean: %g\n&quot;, real_mean);</span></div>
<div class="line">    <span class="comment">//fprintf(stdout, &quot;\treal stddev: %g\n&quot;, real_stddev);</span></div>
<div class="line">    assert(fabs(mean - real_mean) &lt; 1E-2);</div>
<div class="line">    assert(fabs(stddev - real_stddev) &lt; 1E-2);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> discrete_mean_stddev(<span class="keywordtype">size_t</span> N, <span class="keywordtype">double</span> *P, <span class="keywordtype">double</span> *mean, <span class="keywordtype">double</span> *stddev) {</div>
<div class="line">    <span class="comment">// first normalize the array</span></div>
<div class="line">    <span class="keywordtype">double</span> sum = 0.0;</div>
<div class="line">    <span class="keywordtype">int</span> i = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0 ; i &lt; N ; i++) {</div>
<div class="line">        sum += P[i];</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0 ; i &lt; N ; i++) {</div>
<div class="line">        P[i] /= sum;</div>
<div class="line">    }</div>
<div class="line">    *mean = 0.0;</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0 ; i &lt; N ; i++) {</div>
<div class="line">        *mean += i * P[i];</div>
<div class="line">    }</div>
<div class="line">    *stddev = 0.0;</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0 ; i &lt; N ; i++) {</div>
<div class="line">        *stddev += (i - *mean) * (i - *mean) * P[i];</div>
<div class="line">    }</div>
<div class="line">    *stddev = sqrt(*stddev);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test_discrete(<a class="code" href="easy__rng_8h.html#a5662391114b11e8e4941bb6fe2afcc8c">easy_rng</a> *rng) {</div>
<div class="line">    <span class="keywordtype">int</span> i;</div>
<div class="line">    <span class="keywordtype">double</span> mean = 0.0, M2 = 0.0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> P[10] = {0.1, 0.2, 0.3, 0.4, 0.5, 0.5, 0.4, 0.3, 0.2, 0.1};</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="easy__randist_8h.html#a3ec53a0d47be76d2445daead08f4dd32">easy_ran_discrete_t</a> * disc = <a class="code" href="easy__randist_8h.html#a2e40a7447137fd82a5793eb8ee0fa377">easy_ran_discrete_preproc</a>(10, P);</div>
<div class="line"> </div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;Testing easy_ran_discrete\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0 ; i &lt; NSAMPLES ; i++) {</div>
<div class="line">        <span class="keywordtype">double</span> val = (double) <a class="code" href="easy__randist_8h.html#a28f7c40f264a1d335fa694014e078176">easy_ran_discrete</a>(rng, disc);</div>
<div class="line">        <span class="keywordtype">double</span> delta = val - mean;</div>
<div class="line">        mean += delta/(i + 1);</div>
<div class="line">        M2 += delta * (val - mean);</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="easy__randist_8h.html#a5828774909be2bacc2fb50c4e2815162">easy_ran_discrete_free</a>(disc);</div>
<div class="line">    <span class="keywordtype">double</span> stddev = sqrt(M2/NSAMPLES);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tmean: %g\n&quot;</span>, mean);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tstddev: %g\n&quot;</span>, stddev);</div>
<div class="line">    <span class="keywordtype">double</span> real_mean, real_stddev;</div>
<div class="line">    discrete_mean_stddev(10, P, &amp;real_mean, &amp;real_stddev);</div>
<div class="line">    <span class="comment">//fprintf(stdout, &quot;\treal mean: %g\n&quot;, real_mean);</span></div>
<div class="line">    <span class="comment">//fprintf(stdout, &quot;\treal stddev: %g\n&quot;, real_stddev);</span></div>
<div class="line">    assert(fabs(mean - real_mean) &lt; 1E-2);</div>
<div class="line">    assert(fabs(stddev - real_stddev) &lt; 1E-2);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test_poisson(<a class="code" href="easy__rng_8h.html#a5662391114b11e8e4941bb6fe2afcc8c">easy_rng</a> *rng) {</div>
<div class="line">    <span class="keywordtype">int</span> i;</div>
<div class="line">    <span class="keywordtype">double</span> mean = 0.0, M2 = 0.0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> mu = 10.0;</div>
<div class="line"> </div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;Testing easy_ran_poisson\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0 ; i &lt; NSAMPLES ; i++) {</div>
<div class="line">        <span class="keywordtype">double</span> val = <a class="code" href="easy__randist_8h.html#a22e57f0b5a0f69e7c2a6becc1bed6f39">easy_ran_poisson</a>(rng, mu);</div>
<div class="line">        <span class="keywordtype">double</span> delta = val - mean;</div>
<div class="line">        mean += delta/(i + 1);</div>
<div class="line">        M2 += delta * (val - mean);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">double</span> stddev = sqrt(M2/NSAMPLES);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tmean: %g\n&quot;</span>, mean);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tstddev: %g\n&quot;</span>, stddev);</div>
<div class="line">    assert(fabs(mean - mu) &lt; 1E-2);</div>
<div class="line">    assert(fabs(stddev - sqrt(mu)) &lt; 1E-2);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test_bernoulli(<a class="code" href="easy__rng_8h.html#a5662391114b11e8e4941bb6fe2afcc8c">easy_rng</a> *rng) {</div>
<div class="line">    <span class="keywordtype">int</span> i;</div>
<div class="line">    <span class="keywordtype">double</span> mean = 0.0, M2 = 0.0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> mu = 0.25;</div>
<div class="line"> </div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;Testing easy_ran_bernoulli\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0 ; i &lt; NSAMPLES ; i++) {</div>
<div class="line">        <span class="keywordtype">double</span> val = <a class="code" href="easy__randist_8h.html#a3ad85d4d4937bec2128ef9c1eed7fa0f">easy_ran_bernoulli</a>(rng, mu);</div>
<div class="line">        <span class="keywordtype">double</span> delta = val - mean;</div>
<div class="line">        mean += delta/(i + 1);</div>
<div class="line">        M2 += delta * (val - mean);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">double</span> stddev = sqrt(M2/NSAMPLES);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tmean: %g\n&quot;</span>, mean);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tstddev: %g\n&quot;</span>, stddev);</div>
<div class="line">    assert(fabs(mean - mu) &lt; 1E-2);</div>
<div class="line">    assert(fabs(stddev - sqrt(mu*(1.0-mu))) &lt; 1E-2);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test_binomial(<a class="code" href="easy__rng_8h.html#a5662391114b11e8e4941bb6fe2afcc8c">easy_rng</a> *rng) {</div>
<div class="line">    <span class="keywordtype">int</span> i;</div>
<div class="line">    <span class="keywordtype">double</span> mean = 0.0, M2 = 0.0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> p = 0.25;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 25;</div>
<div class="line"> </div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;Testing easy_ran_binomial\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0 ; i &lt; NSAMPLES ; i++) {</div>
<div class="line">        <span class="keywordtype">double</span> val = <a class="code" href="easy__randist_8h.html#a97a24029f6d8cb779da6237f8dbbd21a">easy_ran_binomial</a>(rng, p, n);</div>
<div class="line">        <span class="keywordtype">double</span> delta = val - mean;</div>
<div class="line">        mean += delta/(i + 1);</div>
<div class="line">        M2 += delta * (val - mean);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">double</span> stddev = sqrt(M2/NSAMPLES);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tmean: %g\n&quot;</span>, mean);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tstddev: %g\n&quot;</span>, stddev);</div>
<div class="line">    assert(fabs(mean - p * n) &lt; 1E-2);</div>
<div class="line">    assert(fabs(stddev - sqrt(n * p *(1.0-p))) &lt; 1E-2);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test_negative_binomial(<a class="code" href="easy__rng_8h.html#a5662391114b11e8e4941bb6fe2afcc8c">easy_rng</a> *rng) {</div>
<div class="line">    <span class="keywordtype">int</span> i;</div>
<div class="line">    <span class="keywordtype">double</span> mean = 0.0, M2 = 0.0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> p = 0.25;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 25;</div>
<div class="line"> </div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;Testing easy_ran_negative_binomial\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0 ; i &lt; NSAMPLES ; i++) {</div>
<div class="line">        <span class="keywordtype">double</span> val = <a class="code" href="easy__randist_8h.html#ac2f489458487f814d4617b725f86ac3d">easy_ran_negative_binomial</a>(rng, p, n);</div>
<div class="line">        <span class="keywordtype">double</span> delta = val - mean;</div>
<div class="line">        mean += delta/(i + 1);</div>
<div class="line">        M2 += delta * (val - mean);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">double</span> stddev = sqrt(M2/NSAMPLES);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tmean: %g\n&quot;</span>, mean);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tstddev: %g\n&quot;</span>, stddev);</div>
<div class="line">    assert(fabs(mean - n * (1.0 - p) / p) &lt; 1E-1);</div>
<div class="line">    assert(fabs(stddev - sqrt(n * (1.0 - p) / p / p)) &lt; 1E-1);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> test_geometric(<a class="code" href="easy__rng_8h.html#a5662391114b11e8e4941bb6fe2afcc8c">easy_rng</a> *rng) {</div>
<div class="line">    <span class="keywordtype">int</span> i;</div>
<div class="line">    <span class="keywordtype">double</span> mean = 0.0, M2 = 0.0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> p = 0.25;</div>
<div class="line"> </div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;Testing easy_ran_geometric\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0 ; i &lt; NSAMPLES ; i++) {</div>
<div class="line">        <span class="keywordtype">double</span> val = <a class="code" href="easy__randist_8h.html#ab0c8ec9c31b1b5dd2fe1261d6515d182">easy_ran_geometric</a>(rng, p);</div>
<div class="line">        <span class="keywordtype">double</span> delta = val - mean;</div>
<div class="line">        mean += delta/(i + 1);</div>
<div class="line">        M2 += delta * (val - mean);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">double</span> stddev = sqrt(M2/NSAMPLES);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tmean: %g\n&quot;</span>, mean);</div>
<div class="line">    fprintf(stdout, <span class="stringliteral">&quot;\tstddev: %g\n&quot;</span>, stddev);</div>
<div class="line">    assert(fabs(mean - 1.0/p) &lt; 1E-2);</div>
<div class="line">    assert(fabs(stddev - sqrt((1.0 - p) / p / p)) &lt; 1E-2);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="easy__rng_8h.html#a5662391114b11e8e4941bb6fe2afcc8c">easy_rng</a> *rng = <a class="code" href="easy__rng_8h.html#a34837a567a02ed025cc5230cafcfa30a">easy_rng_alloc</a>(<a class="code" href="easy__rng_8h.html#a03a2111e5941ce6a20a210cf6017c13d">easy_rng_mt19937</a>);</div>
<div class="line">    <span class="comment">// ensure we get a different seed every time...</span></div>
<div class="line">    <a class="code" href="easy__rng_8h.html#a4cde3fe49fdd3a78826ffcc3a440c5b6">easy_rng_set</a>(rng, (<span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) time(NULL));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// run some checks on the distributions</span></div>
<div class="line">    test_uniform(rng);</div>
<div class="line">    test_uniform_pos(rng);</div>
<div class="line">    test_uniform_int(rng);</div>
<div class="line">    test_gaussian(rng);</div>
<div class="line">    test_ugaussian(rng);</div>
<div class="line">    test_exponential(rng);</div>
<div class="line">    <span class="comment">//test_cauchy(); // mean and stddev are undefined here</span></div>
<div class="line">    test_gamma(rng);</div>
<div class="line">    test_flat(rng);</div>
<div class="line">    test_lognormal(rng);</div>
<div class="line">    test_chisq(rng);</div>
<div class="line">    <span class="comment">//test_fdist(rng); // this test fails now and then...</span></div>
<div class="line">    test_tdist(rng);</div>
<div class="line">    test_weibull(rng);</div>
<div class="line">    test_discrete(rng);</div>
<div class="line">    test_poisson(rng);</div>
<div class="line">    test_bernoulli(rng);</div>
<div class="line">    test_binomial(rng);</div>
<div class="line">    test_negative_binomial(rng);</div>
<div class="line">    test_geometric(rng);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="easy__rng_8h.html#a19d630d55113cfac076a582a6e4863ba">easy_rng_free</a>(rng);</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --> <h1><a class="anchor" id="test4"></a>
Test 4: random number generator Fortran API validation</h1>
<div class="fragment"><div class="line"><span class="keyword">PROGRAM</span> test4</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">USE </span>:: easyrng</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_fortran_env</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">! exit is a commonly found extension but I want this example to be fully standard compliant...</span></div>
<div class="line"><span class="keyword">INTERFACE</span></div>
<div class="line">  <span class="keyword">SUBROUTINE </span>easy_exit(exit_status) bind(C, NAME=&#39;exit&#39;)</div>
<div class="line">    use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line">    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line">    <span class="keywordtype">INTEGER (C_INT)</span>, <span class="keywordtype">INTENT(IN)</span>, <span class="keywordtype">VALUE</span> :: exit_status</div>
<div class="line">  <span class="keyword">ENDSUBROUTINE </span>easy_exit</div>
<div class="line"><span class="keyword">ENDINTERFACE</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">TYPE</span> (easy_rng) :: rng</div>
<div class="line"><span class="keywordtype">TYPE</span> (easy_rng) :: rng_clone</div>
<div class="line"><span class="keywordtype">INTEGER (C_LONG)</span> :: val</div>
<div class="line"><span class="keywordtype">INTEGER</span> :: i</div>
<div class="line"><span class="keywordtype">TYPE</span> (easy_rng_type), <span class="keywordtype">POINTER</span>, <span class="keywordtype">DIMENSION(:)</span> :: all_types</div>
<div class="line"> </div>
<div class="line">all_types =&gt; <a class="code" href="easy__rng_8h.html#a48ab27e3436e334bacfe4552c77a8293">easy_rng_types_setup</a>()</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">DO</span> i=1,<span class="keyword">SIZE</span>(all_types)</div>
<div class="line"> </div>
<div class="line">  rng = <a class="code" href="easy__rng_8h.html#a34837a567a02ed025cc5230cafcfa30a">easy_rng_alloc</a>(all_types(i))</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">CALL </span><a class="code" href="easy__rng_8h.html#a4cde3fe49fdd3a78826ffcc3a440c5b6">easy_rng_set</a>(rng, 1234_c_long)</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">WRITE</span>(output_unit, <span class="stringliteral">&#39;(A, I25)&#39;</span>) <span class="stringliteral">&#39;get: &#39;</span>, <a class="code" href="easy__rng_8h.html#a6df8544bca640da8fc342b835420372c">easy_rng_get</a>(rng)</div>
<div class="line">  <span class="keyword">WRITE</span>(output_unit, <span class="stringliteral">&#39;(A, ES15.6)&#39;</span>) <span class="stringliteral">&#39;uniform: &#39;</span>, <a class="code" href="easy__rng_8h.html#a1d59580b57d8241e420d989afc3cf226">easy_rng_uniform</a>(rng)</div>
<div class="line">  <span class="keyword">WRITE</span>(output_unit, <span class="stringliteral">&#39;(A, ES15.6)&#39;</span>) <span class="stringliteral">&#39;uniform_pos: &#39;</span>, <a class="code" href="easy__rng_8h.html#abb81d00f216d1c72cc7a4faee4839ac9">easy_rng_uniform_pos</a>(rng)</div>
<div class="line">  <span class="keyword">WRITE</span>(output_unit, <span class="stringliteral">&#39;(A, I3)&#39;</span>) <span class="stringliteral">&#39;uniform_int: &#39;</span>, <a class="code" href="easy__rng_8h.html#a20307b97d36836c046d57794ee241174">easy_rng_uniform_int</a>(rng, 10_c_long)</div>
<div class="line">  <span class="keyword">WRITE</span>(output_unit, <span class="stringliteral">&#39;(A, A)&#39;</span>) <span class="stringliteral">&#39;name: &#39;</span>, <a class="code" href="easy__rng_8h.html#a5283493f3e6510dc16ea6243a3064cc8">easy_rng_name</a>(rng)</div>
<div class="line">  <span class="keyword">WRITE</span>(output_unit, <span class="stringliteral">&#39;(A, I25)&#39;</span>) <span class="stringliteral">&#39;min: &#39;</span>, <a class="code" href="easy__rng_8h.html#ab7ebef8f2b34c0e623a67558ecc7aff8">easy_rng_min</a>(rng)</div>
<div class="line">  <span class="keyword">WRITE</span>(output_unit, <span class="stringliteral">&#39;(A, I25)&#39;</span>) <span class="stringliteral">&#39;max: &#39;</span>, <a class="code" href="easy__rng_8h.html#ae10e10fb6573d977a7b7fdd89000ce02">easy_rng_max</a>(rng)</div>
<div class="line"> </div>
<div class="line">  <span class="comment">! test cloning</span></div>
<div class="line">  rng_clone = <a class="code" href="easy__rng_8h.html#a5721c3419d7f703d74877df274d59a5d">easy_rng_clone</a>(rng)</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">IF</span> (<a class="code" href="easy__rng_8h.html#a42e237e12705f24d1bc9185dd85da87a">easy_rng_equal</a>(rng, rng_clone) .EQ. 0) <span class="keywordflow">THEN</span></div>
<div class="line">    <span class="keyword">CALL </span>easy_exit(1)</div>
<div class="line"><span class="keywordflow">  ENDIF</span></div>
<div class="line"> </div>
<div class="line">  val = <a class="code" href="easy__rng_8h.html#a6df8544bca640da8fc342b835420372c">easy_rng_get</a>(rng_clone)</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">IF</span> (<a class="code" href="easy__rng_8h.html#a42e237e12705f24d1bc9185dd85da87a">easy_rng_equal</a>(rng, rng_clone) .EQ. 1) <span class="keywordflow">THEN</span></div>
<div class="line">    <span class="keyword">CALL </span>easy_exit(1)</div>
<div class="line"><span class="keywordflow">  ENDIF</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">CALL </span><a class="code" href="easy__rng_8h.html#a19d630d55113cfac076a582a6e4863ba">easy_rng_free</a>(rng)</div>
<div class="line">  <span class="keyword">CALL </span><a class="code" href="easy__rng_8h.html#a19d630d55113cfac076a582a6e4863ba">easy_rng_free</a>(rng_clone)</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">ENDDO</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">ENDPROGRAM </span>test4</div>
</div><!-- fragment --> <h1><a class="anchor" id="test5"></a>
Test 5: random number generator Fortran API performance test</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#ifndef NRUNS</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define NRUNS 10000000</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span> </div>
<div class="line"><span class="keyword">SUBROUTINE </span>run_test(ftype, etype)</div>
<div class="line">  use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line">  use, <span class="keywordtype">INTRINSIC</span> :: iso_fortran_env</div>
<div class="line">  <span class="keywordtype">USE </span>:: fgsl</div>
<div class="line">  <span class="keywordtype">USE </span>:: easyrng</div>
<div class="line">  <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">TYPE</span> (fgsl_rng_type), <span class="keywordtype">INTENT(INOUT)</span> :: ftype</div>
<div class="line">  <span class="keywordtype">TYPE</span> (easy_rng_type), <span class="keywordtype">INTENT(IN)</span> :: etype</div>
<div class="line">  <span class="keywordtype">TYPE</span> (fgsl_rng) :: frng</div>
<div class="line">  <span class="keywordtype">TYPE</span> (easy_rng) :: erng</div>
<div class="line"><span class="keywordtype">  REAL</span> (C_DOUBLE) :: fstart, fend</div>
<div class="line"><span class="keywordtype">  REAL</span> (C_DOUBLE) :: estart, eend</div>
<div class="line">  <span class="keywordtype">INTEGER (C_LONG)</span> :: i</div>
<div class="line">  <span class="keywordtype">INTEGER (C_LONG)</span> :: rng_rv</div>
<div class="line"> </div>
<div class="line">  frng = fgsl_rng_alloc(ftype)</div>
<div class="line">  erng = <a class="code" href="easy__rng_8h.html#a34837a567a02ed025cc5230cafcfa30a">easy_rng_alloc</a>(etype)</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">CALL </span>cpu_time(fstart)</div>
<div class="line">  <span class="keywordflow">DO</span> i=1,nruns</div>
<div class="line">    rng_rv = fgsl_rng_get(frng)</div>
<div class="line"><span class="keywordflow">  ENDDO</span></div>
<div class="line">  <span class="keyword">CALL </span>cpu_time(fend)</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">CALL </span>cpu_time(estart)</div>
<div class="line">  <span class="keywordflow">DO</span> i=1,nruns</div>
<div class="line">    rng_rv = <a class="code" href="easy__rng_8h.html#a6df8544bca640da8fc342b835420372c">easy_rng_get</a>(erng)</div>
<div class="line"><span class="keywordflow">  ENDDO</span></div>
<div class="line">  <span class="keyword">CALL </span>cpu_time(eend)</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,A,A,A)&#39;</span>) <span class="stringliteral">&#39;Comparing easyRNGs &#39;</span>, trim(<a class="code" href="easy__rng_8h.html#a5283493f3e6510dc16ea6243a3064cc8">easy_rng_name</a>(erng)), &amp;</div>
<div class="line">    <span class="stringliteral">&#39; with FGSLs &#39;</span>, trim(fgsl_rng_name(frng))</div>
<div class="line">  <span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,F10.3)&#39;</span>) <span class="stringliteral">&#39;easyRNG &#39;</span>, eend - estart</div>
<div class="line">  <span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,F10.3)&#39;</span>) <span class="stringliteral">&#39;FGSL &#39;</span>, fend - fstart</div>
<div class="line">  <span class="keyword">CALL </span>fgsl_rng_free(frng)</div>
<div class="line">  <span class="keyword">CALL </span><a class="code" href="easy__rng_8h.html#a19d630d55113cfac076a582a6e4863ba">easy_rng_free</a>(erng)</div>
<div class="line"> </div>
<div class="line"><span class="keyword">ENDSUBROUTINE </span>run_test</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">PROGRAM</span> test5</div>
<div class="line">  <span class="keywordtype">USE </span>:: fgsl</div>
<div class="line">  <span class="keywordtype">USE </span>:: easyrng</div>
<div class="line">  <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">CALL </span>run_test(fgsl_rng_mt19937, easy_rng_mt19937)</div>
<div class="line">  <span class="keyword">CALL </span>run_test(fgsl_rng_ranlux, easy_rng_ranlux24)</div>
<div class="line">  <span class="keyword">CALL </span>run_test(fgsl_rng_ranlux389, easy_rng_ranlux48)</div>
<div class="line">  <span class="keyword">CALL </span>run_test(fgsl_rng_minstd, easy_rng_minstd_rand0)</div>
<div class="line">  <span class="keyword">CALL </span>run_test(fgsl_rng_fishman20, easy_rng_minstd_rand)</div>
<div class="line"><span class="keyword">ENDPROGRAM </span>test5</div>
<div class="line"> </div>
<div class="line"> </div>
</div><!-- fragment --> <h1><a class="anchor" id="test6"></a>
Test 6: random number distributions Fortran API accuracy test</h1>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#define NSAMPLES 10000000</span></div>
<div class="line"><span class="preprocessor"></span> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">PROGRAM</span> test6</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line"><span class="keywordtype">USE </span>:: easyrng</div>
<div class="line"><span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">TYPE</span> (easy_rng) :: rng</div>
<div class="line"> </div>
<div class="line"><span class="keyword">INTERFACE</span> </div>
<div class="line">  <span class="keyword">FUNCTION </span>easy_time(timer) bind(C, NAME=&#39;time&#39;) <span class="keyword">RESULT</span>(rv)</div>
<div class="line">    use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line">    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line">    <span class="keywordtype">TYPE</span> (C_PTR), <span class="keywordtype">INTENT(IN)</span>, <span class="keywordtype">VALUE</span> :: timer</div>
<div class="line">    <span class="keywordtype">INTEGER (C_LONG)</span> :: rv</div>
<div class="line">  <span class="keyword">ENDFUNCTION </span>easy_time</div>
<div class="line"><span class="keyword">ENDINTERFACE</span></div>
<div class="line"> </div>
<div class="line">rng = <a class="code" href="easy__rng_8h.html#a34837a567a02ed025cc5230cafcfa30a">easy_rng_alloc</a>(easy_rng_mt19937)</div>
<div class="line"><span class="keyword">CALL </span><a class="code" href="easy__rng_8h.html#a4cde3fe49fdd3a78826ffcc3a440c5b6">easy_rng_set</a>(rng, easy_time(c_null_ptr))</div>
<div class="line"> </div>
<div class="line"><span class="keyword">CALL </span>test_uniform(rng)</div>
<div class="line"><span class="keyword">CALL </span>test_uniform_pos(rng)</div>
<div class="line"><span class="keyword">CALL </span>test_uniform_int(rng)</div>
<div class="line"><span class="keyword">CALL </span>test_gaussian(rng)</div>
<div class="line"><span class="keyword">CALL </span>test_ugaussian(rng)</div>
<div class="line"><span class="keyword">CALL </span>test_exponential(rng)</div>
<div class="line"><span class="keyword">CALL </span>test_gamma(rng) <span class="comment">! this one also appears to fail now and then...</span></div>
<div class="line"><span class="keyword">CALL </span>test_flat(rng)</div>
<div class="line"><span class="keyword">CALL </span>test_lognormal(rng)</div>
<div class="line"><span class="keyword">CALL </span>test_chisq(rng)</div>
<div class="line"><span class="comment">!CALL test_fdist(rng) ! this one fails often, not sure why...</span></div>
<div class="line"><span class="keyword">CALL </span>test_tdist(rng)</div>
<div class="line"><span class="keyword">CALL </span>test_weibull(rng)</div>
<div class="line"><span class="keyword">CALL </span>test_discrete(rng)</div>
<div class="line"><span class="keyword">CALL </span>test_poisson(rng)</div>
<div class="line"><span class="keyword">CALL </span>test_bernoulli(rng)</div>
<div class="line"><span class="keyword">CALL </span>test_binomial(rng)</div>
<div class="line"><span class="keyword">CALL </span>test_negative_binomial(rng)</div>
<div class="line"><span class="keyword">CALL </span>test_geometric(rng)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">CALL </span><a class="code" href="easy__rng_8h.html#a19d630d55113cfac076a582a6e4863ba">easy_rng_free</a>(rng)</div>
<div class="line"> </div>
<div class="line"><span class="keyword">CONTAINS</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">SUBROUTINE </span>assert(condition, line)</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_fortran_env</div>
<div class="line"><span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">LOGICAL</span>, <span class="keywordtype">INTENT(IN)</span> :: condition</div>
<div class="line"><span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: line</div>
<div class="line"> </div>
<div class="line"><span class="keyword">INTERFACE</span></div>
<div class="line">  <span class="keyword">SUBROUTINE </span>easy_exit(exit_status) bind(C, NAME=&#39;exit&#39;)</div>
<div class="line">    use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line">    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line">    <span class="keywordtype">INTEGER (C_INT)</span>, <span class="keywordtype">INTENT(IN)</span>, <span class="keywordtype">VALUE</span> :: exit_status</div>
<div class="line">  <span class="keyword">ENDSUBROUTINE </span>easy_exit</div>
<div class="line"><span class="keyword">ENDINTERFACE</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">IF</span> (condition .EQV. .false.) <span class="keywordflow">THEN</span></div>
<div class="line">  <span class="keyword">WRITE</span> (error_unit, <span class="stringliteral">&#39;(A,I4)&#39;</span>) <span class="stringliteral">&#39;assert failure at line &#39;</span>, line</div>
<div class="line">  <span class="keyword">CALL </span>easy_exit(1_c_int)</div>
<div class="line"><span class="keywordflow">ENDIF</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">ENDSUBROUTINE </span>assert</div>
<div class="line"> </div>
<div class="line"><span class="keyword">SUBROUTINE </span>test_uniform(rng)</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_fortran_env</div>
<div class="line"><span class="keywordtype">USE </span>:: easyrng</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">TYPE</span> (easy_rng), <span class="keywordtype">INTENT(IN)</span> :: rng</div>
<div class="line"><span class="keywordtype">INTEGER</span> :: i</div>
<div class="line">real(c_double) :: mean, m2, val, delta, stddev</div>
<div class="line"> </div>
<div class="line">mean = 0.0_c_double</div>
<div class="line">m2 = 0.0_c_double</div>
<div class="line"> </div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;Testing easy_rng_uniform&#39;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">DO</span> i=1, nsamples</div>
<div class="line">  val = <a class="code" href="easy__rng_8h.html#a1d59580b57d8241e420d989afc3cf226">easy_rng_uniform</a>(rng)</div>
<div class="line">  delta = val - mean</div>
<div class="line">  mean = mean + delta/i</div>
<div class="line">  m2 = m2 + delta * (val - mean)</div>
<div class="line"><span class="keywordflow">ENDDO</span></div>
<div class="line">stddev = sqrt(m2/nsamples)</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      mean: &#39;</span>, mean</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      stddev: &#39;</span>, stddev</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(mean - 0.5) &lt; 1e-3, __line__)</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(stddev - sqrt(1.0/12.0)) &lt; 1e-3, __line__)</div>
<div class="line"> </div>
<div class="line"><span class="keyword">ENDSUBROUTINE </span>test_uniform</div>
<div class="line"> </div>
<div class="line"><span class="keyword">SUBROUTINE </span>test_uniform_pos(rng)</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_fortran_env</div>
<div class="line"><span class="keywordtype">USE </span>:: easyrng</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">TYPE</span> (easy_rng), <span class="keywordtype">INTENT(IN)</span> :: rng</div>
<div class="line"><span class="keywordtype">INTEGER</span> :: i</div>
<div class="line">real(c_double) :: mean, m2, val, delta, stddev</div>
<div class="line"> </div>
<div class="line">mean = 0.0_c_double</div>
<div class="line">m2 = 0.0_c_double</div>
<div class="line"> </div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;Testing easy_rng_uniform_pos&#39;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">DO</span> i=1, nsamples</div>
<div class="line">  val = <a class="code" href="easy__rng_8h.html#abb81d00f216d1c72cc7a4faee4839ac9">easy_rng_uniform_pos</a>(rng)</div>
<div class="line">  delta = val - mean</div>
<div class="line">  mean = mean + delta/i</div>
<div class="line">  m2 = m2 + delta * (val - mean)</div>
<div class="line"><span class="keywordflow">ENDDO</span></div>
<div class="line">stddev = sqrt(m2/nsamples)</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      mean: &#39;</span>, mean</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      stddev: &#39;</span>, stddev</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(mean - 0.5) &lt; 1e-3, __line__)</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(stddev - sqrt(1.0/12.0)) &lt; 1e-3, __line__)</div>
<div class="line"> </div>
<div class="line"><span class="keyword">ENDSUBROUTINE </span>test_uniform_pos</div>
<div class="line"> </div>
<div class="line"><span class="keyword">SUBROUTINE </span>test_uniform_int(rng)</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_fortran_env</div>
<div class="line"><span class="keywordtype">USE </span>:: easyrng</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">TYPE</span> (easy_rng), <span class="keywordtype">INTENT(IN)</span> :: rng</div>
<div class="line"><span class="keywordtype">INTEGER</span> :: i</div>
<div class="line">real(c_double) :: mean, m2, val, delta, stddev</div>
<div class="line"> </div>
<div class="line">mean = 0.0_c_double</div>
<div class="line">m2 = 0.0_c_double</div>
<div class="line"> </div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;Testing easy_rng_uniform_int&#39;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">DO</span> i=1, nsamples</div>
<div class="line">  val = real(<a class="code" href="easy__rng_8h.html#a20307b97d36836c046d57794ee241174">easy_rng_uniform_int</a>(rng, 10000_c_long), c_double)</div>
<div class="line">  delta = val - mean</div>
<div class="line">  mean = mean + delta/i</div>
<div class="line">  m2 = m2 + delta * (val - mean)</div>
<div class="line"><span class="keywordflow">ENDDO</span></div>
<div class="line">stddev = sqrt(m2/nsamples)</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      mean: &#39;</span>, mean</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      stddev: &#39;</span>, stddev</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(mean - 5000) &lt; 10, __line__)</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(stddev - sqrt(10000.0**2/12.0)) &lt; 10, __line__)</div>
<div class="line"> </div>
<div class="line"><span class="keyword">ENDSUBROUTINE </span>test_uniform_int</div>
<div class="line"> </div>
<div class="line"><span class="keyword">SUBROUTINE </span>test_gaussian(rng)</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_fortran_env</div>
<div class="line"><span class="keywordtype">USE </span>:: easyrng</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">TYPE</span> (easy_rng), <span class="keywordtype">INTENT(IN)</span> :: rng</div>
<div class="line"><span class="keywordtype">INTEGER</span> :: i</div>
<div class="line">real(c_double) :: mean, m2, val, delta, stddev</div>
<div class="line"> </div>
<div class="line">mean = 0.0_c_double</div>
<div class="line">m2 = 0.0_c_double</div>
<div class="line"> </div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;Testing easy_ran_gaussian&#39;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">DO</span> i=1, nsamples</div>
<div class="line">  val = <a class="code" href="easy__randist_8h.html#aa73ac6dbe5840c804b3419926ee72641">easy_ran_gaussian</a>(rng, 5.0_c_double)</div>
<div class="line">  delta = val - mean</div>
<div class="line">  mean = mean + delta/i</div>
<div class="line">  m2 = m2 + delta * (val - mean)</div>
<div class="line"><span class="keywordflow">ENDDO</span></div>
<div class="line">stddev = sqrt(m2/nsamples)</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      mean: &#39;</span>, mean</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      stddev: &#39;</span>, stddev</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(mean - 0.0) &lt; 1e-2, __line__)</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(stddev - 5.0) &lt; 1e-2, __line__)</div>
<div class="line"> </div>
<div class="line"><span class="keyword">ENDSUBROUTINE </span>test_gaussian</div>
<div class="line"> </div>
<div class="line"><span class="keyword">SUBROUTINE </span>test_ugaussian(rng)</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_fortran_env</div>
<div class="line"><span class="keywordtype">USE </span>:: easyrng</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">TYPE</span> (easy_rng), <span class="keywordtype">INTENT(IN)</span> :: rng</div>
<div class="line"><span class="keywordtype">INTEGER</span> :: i</div>
<div class="line">real(c_double) :: mean, m2, val, delta, stddev</div>
<div class="line"> </div>
<div class="line">mean = 0.0_c_double</div>
<div class="line">m2 = 0.0_c_double</div>
<div class="line"> </div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;Testing easy_ran_ugaussian&#39;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">DO</span> i=1, nsamples</div>
<div class="line">  val = <a class="code" href="easy__randist_8h.html#a8ac93416e4da2d0429ac109e6cc234e8">easy_ran_ugaussian</a>(rng)</div>
<div class="line">  delta = val - mean</div>
<div class="line">  mean = mean + delta/i</div>
<div class="line">  m2 = m2 + delta * (val - mean)</div>
<div class="line"><span class="keywordflow">ENDDO</span></div>
<div class="line">stddev = sqrt(m2/nsamples)</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      mean: &#39;</span>, mean</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      stddev: &#39;</span>, stddev</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(mean - 0.0) &lt; 1e-2, __line__)</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(stddev - 1.0) &lt; 1e-2, __line__)</div>
<div class="line"> </div>
<div class="line"><span class="keyword">ENDSUBROUTINE </span>test_ugaussian</div>
<div class="line"> </div>
<div class="line"><span class="keyword">SUBROUTINE </span>test_exponential(rng)</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_fortran_env</div>
<div class="line"><span class="keywordtype">USE </span>:: easyrng</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">TYPE</span> (easy_rng), <span class="keywordtype">INTENT(IN)</span> :: rng</div>
<div class="line"><span class="keywordtype">INTEGER</span> :: i</div>
<div class="line">real(c_double) :: mean, m2, val, delta, stddev</div>
<div class="line">real(c_double), <span class="keywordtype">PARAMETER</span> :: mu = 5.1047e-05_c_double</div>
<div class="line"> </div>
<div class="line">mean = 0.0_c_double</div>
<div class="line">m2 = 0.0_c_double</div>
<div class="line"> </div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;Testing easy_ran_exponential&#39;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">DO</span> i=1, nsamples</div>
<div class="line">  val = <a class="code" href="easy__randist_8h.html#aa2ddd4ffca96f5a5700c700a8091fc6d">easy_ran_exponential</a>(rng, mu)</div>
<div class="line">  delta = val - mean</div>
<div class="line">  mean = mean + delta/i</div>
<div class="line">  m2 = m2 + delta * (val - mean)</div>
<div class="line"><span class="keywordflow">ENDDO</span></div>
<div class="line">stddev = sqrt(m2/nsamples)</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      mean: &#39;</span>, mean</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      stddev: &#39;</span>, stddev</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(mean - mu)/mean &lt; 1e-2, __line__)</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(stddev - mu)/mean &lt; 1e-2, __line__)</div>
<div class="line"> </div>
<div class="line"><span class="keyword">ENDSUBROUTINE </span>test_exponential</div>
<div class="line"> </div>
<div class="line"><span class="keyword">SUBROUTINE </span>test_gamma(rng)</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_fortran_env</div>
<div class="line"><span class="keywordtype">USE </span>:: easyrng</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">TYPE</span> (easy_rng), <span class="keywordtype">INTENT(IN)</span> :: rng</div>
<div class="line"><span class="keywordtype">INTEGER</span> :: i</div>
<div class="line">real(c_double) :: mean, m2, val, delta, stddev</div>
<div class="line"> </div>
<div class="line">mean = 0.0_c_double</div>
<div class="line">m2 = 0.0_c_double</div>
<div class="line"> </div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;Testing easy_ran_gamma&#39;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">DO</span> i=1, nsamples</div>
<div class="line">  val = <a class="code" href="easy__randist_8h.html#aa58eb8b44c683e0852e406bf0e7abcc1">easy_ran_gamma</a>(rng, 10.0_c_double, 5.0_c_double)</div>
<div class="line">  delta = val - mean</div>
<div class="line">  mean = mean + delta/i</div>
<div class="line">  m2 = m2 + delta * (val - mean)</div>
<div class="line"><span class="keywordflow">ENDDO</span></div>
<div class="line">stddev = sqrt(m2/nsamples)</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      mean: &#39;</span>, mean</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      stddev: &#39;</span>, stddev</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(mean - 50.0) &lt; 1e-1, __line__)</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(stddev - sqrt(10.0 * 5.0 * 5.0))/sqrt(10.0 * 5.0 * 5.0) &lt; 1e-2, __line__)</div>
<div class="line"> </div>
<div class="line"><span class="keyword">ENDSUBROUTINE </span>test_gamma</div>
<div class="line"> </div>
<div class="line"><span class="keyword">SUBROUTINE </span>test_flat(rng)</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_fortran_env</div>
<div class="line"><span class="keywordtype">USE </span>:: easyrng</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">TYPE</span> (easy_rng), <span class="keywordtype">INTENT(IN)</span> :: rng</div>
<div class="line"><span class="keywordtype">INTEGER</span> :: i</div>
<div class="line">real(c_double) :: mean, m2, val, delta, stddev</div>
<div class="line"> </div>
<div class="line">mean = 0.0_c_double</div>
<div class="line">m2 = 0.0_c_double</div>
<div class="line"> </div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;Testing easy_ran_flat&#39;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">DO</span> i=1, nsamples</div>
<div class="line">  val = <a class="code" href="easy__randist_8h.html#a04c98539c263989a99dae4457e6ac361">easy_ran_flat</a>(rng, 95.0_c_double, 458.0_c_double)</div>
<div class="line">  delta = val - mean</div>
<div class="line">  mean = mean + delta/i</div>
<div class="line">  m2 = m2 + delta * (val - mean)</div>
<div class="line"><span class="keywordflow">ENDDO</span></div>
<div class="line">stddev = sqrt(m2/nsamples)</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      mean: &#39;</span>, mean</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      stddev: &#39;</span>, stddev</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(mean - (458.0 + 95.0)/2.0) &lt; 1.0, __line__)</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(stddev - sqrt(1.0/12.0) * (458.0 - 95.0)) &lt; 1.0, __line__)</div>
<div class="line"> </div>
<div class="line"><span class="keyword">ENDSUBROUTINE </span>test_flat</div>
<div class="line"> </div>
<div class="line"><span class="keyword">SUBROUTINE </span>test_lognormal(rng)</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_fortran_env</div>
<div class="line"><span class="keywordtype">USE </span>:: easyrng</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">TYPE</span> (easy_rng), <span class="keywordtype">INTENT(IN)</span> :: rng</div>
<div class="line"><span class="keywordtype">INTEGER</span> :: i</div>
<div class="line">real(c_double) :: mean, m2, val, delta, stddev</div>
<div class="line">real(c_double), <span class="keywordtype">PARAMETER</span> :: zeta = 0.5, sigma = 0.2</div>
<div class="line"> </div>
<div class="line">mean = 0.0_c_double</div>
<div class="line">m2 = 0.0_c_double</div>
<div class="line"> </div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;Testing easy_ran_lognormal&#39;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">DO</span> i=1, nsamples</div>
<div class="line">  val = <a class="code" href="easy__randist_8h.html#acff3c5fc0e1788a0e0f312b11614cd08">easy_ran_lognormal</a>(rng, zeta, sigma)</div>
<div class="line">  delta = val - mean</div>
<div class="line">  mean = mean + delta/i</div>
<div class="line">  m2 = m2 + delta * (val - mean)</div>
<div class="line"><span class="keywordflow">ENDDO</span></div>
<div class="line">stddev = sqrt(m2/nsamples)</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      mean: &#39;</span>, mean</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      stddev: &#39;</span>, stddev</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(mean - exp(zeta + sigma * sigma / 2.0)) &lt; 1e-2, __line__)</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(stddev - sqrt((exp(sigma * sigma) - 1.0) * exp(2.0 * zeta + sigma * sigma) )) &lt; 1e-2, __line__)</div>
<div class="line"> </div>
<div class="line"><span class="keyword">ENDSUBROUTINE </span>test_lognormal</div>
<div class="line"> </div>
<div class="line"><span class="keyword">SUBROUTINE </span>test_chisq(rng)</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_fortran_env</div>
<div class="line"><span class="keywordtype">USE </span>:: easyrng</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">TYPE</span> (easy_rng), <span class="keywordtype">INTENT(IN)</span> :: rng</div>
<div class="line"><span class="keywordtype">INTEGER</span> :: i</div>
<div class="line">real(c_double) :: mean, m2, val, delta, stddev</div>
<div class="line">real(c_double), <span class="keywordtype">PARAMETER</span> :: nu = 10.0</div>
<div class="line"> </div>
<div class="line">mean = 0.0_c_double</div>
<div class="line">m2 = 0.0_c_double</div>
<div class="line"> </div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;Testing easy_ran_chisq&#39;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">DO</span> i=1, nsamples</div>
<div class="line">  val = <a class="code" href="easy__randist_8h.html#ae5338d2afbcfbd97e6a130d485c2fc1b">easy_ran_chisq</a>(rng, nu)</div>
<div class="line">  delta = val - mean</div>
<div class="line">  mean = mean + delta/i</div>
<div class="line">  m2 = m2 + delta * (val - mean)</div>
<div class="line"><span class="keywordflow">ENDDO</span></div>
<div class="line">stddev = sqrt(m2/nsamples)</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      mean: &#39;</span>, mean</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      stddev: &#39;</span>, stddev</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(mean - nu) &lt; 1e-2, __line__)</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(stddev - sqrt(2.0 * nu)) &lt; 1e-2, __line__)</div>
<div class="line"> </div>
<div class="line"><span class="keyword">ENDSUBROUTINE </span>test_chisq</div>
<div class="line"> </div>
<div class="line"><span class="keyword">FUNCTION </span>fdist_stddev(nu1, nu2) <span class="keyword">RESULT</span>(rv)</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line"><span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line">real(c_double), <span class="keywordtype">INTENT(IN)</span> :: nu1, nu2</div>
<div class="line">real(c_double) :: rv</div>
<div class="line">rv = sqrt(2.0 * nu2 * nu2 * (nu1 + nu2 - 2.0) / nu1 / (nu2 - 2.0) / (nu2 -2.0) / (nu2 - 4.0))</div>
<div class="line"><span class="keyword">ENDFUNCTION </span>fdist_stddev</div>
<div class="line"> </div>
<div class="line"><span class="keyword">SUBROUTINE </span>test_fdist(rng)</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_fortran_env</div>
<div class="line"><span class="keywordtype">USE </span>:: easyrng</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">TYPE</span> (easy_rng), <span class="keywordtype">INTENT(IN)</span> :: rng</div>
<div class="line"><span class="keywordtype">INTEGER</span> :: i</div>
<div class="line">real(c_double) :: mean, m2, val, delta, stddev, real_stddev</div>
<div class="line">real(c_double), <span class="keywordtype">PARAMETER</span> :: nu1 = 10.0, nu2 = 5.0</div>
<div class="line"> </div>
<div class="line">mean = 0.0_c_double</div>
<div class="line">m2 = 0.0_c_double</div>
<div class="line"> </div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;Testing easy_ran_fdist&#39;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">DO</span> i=1, nsamples</div>
<div class="line">  val = <a class="code" href="easy__randist_8h.html#a8e9aa28448987c10b9c11aa9b802a39b">easy_ran_fdist</a>(rng, nu1, nu2)</div>
<div class="line">  delta = val - mean</div>
<div class="line">  mean = mean + delta/i</div>
<div class="line">  m2 = m2 + delta * (val - mean)</div>
<div class="line"><span class="keywordflow">ENDDO</span></div>
<div class="line">stddev = sqrt(m2/nsamples)</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      mean: &#39;</span>, mean</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      stddev: &#39;</span>, stddev</div>
<div class="line">real_stddev = fdist_stddev(nu1, nu2)</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      real stddev: &#39;</span>, real_stddev</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(mean - nu2/(nu2 - 2.0)) &lt; 1e-2, __line__)</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(stddev - real_stddev) &lt; 5.0e-1, __line__)</div>
<div class="line"> </div>
<div class="line"><span class="keyword">ENDSUBROUTINE </span>test_fdist</div>
<div class="line"> </div>
<div class="line"><span class="keyword">SUBROUTINE </span>test_tdist(rng)</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_fortran_env</div>
<div class="line"><span class="keywordtype">USE </span>:: easyrng</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">TYPE</span> (easy_rng), <span class="keywordtype">INTENT(IN)</span> :: rng</div>
<div class="line"><span class="keywordtype">INTEGER</span> :: i</div>
<div class="line">real(c_double) :: mean, m2, val, delta, stddev</div>
<div class="line">real(c_double), <span class="keywordtype">PARAMETER</span> :: nu = 10.0</div>
<div class="line"> </div>
<div class="line">mean = 0.0_c_double</div>
<div class="line">m2 = 0.0_c_double</div>
<div class="line"> </div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;Testing easy_ran_tdist&#39;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">DO</span> i=1, nsamples</div>
<div class="line">  val = <a class="code" href="easy__randist_8h.html#a8dda25bf957f749bf12974701984529e">easy_ran_tdist</a>(rng, nu)</div>
<div class="line">  delta = val - mean</div>
<div class="line">  mean = mean + delta/i</div>
<div class="line">  m2 = m2 + delta * (val - mean)</div>
<div class="line"><span class="keywordflow">ENDDO</span></div>
<div class="line">stddev = sqrt(m2/nsamples)</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      mean: &#39;</span>, mean</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      stddev: &#39;</span>, stddev</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(mean - 0.0) &lt; 1e-2, __line__)</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(stddev - sqrt(nu/(nu - 2.0))) &lt; 1.0e-2, __line__)</div>
<div class="line"> </div>
<div class="line"><span class="keyword">ENDSUBROUTINE </span>test_tdist</div>
<div class="line"> </div>
<div class="line"><span class="keyword">FUNCTION </span>weibull_mean(a, b) <span class="keyword">RESULT</span>(rv)</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line"><span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line">real(c_double), <span class="keywordtype">INTENT(IN)</span> :: a, b</div>
<div class="line">real(c_double) :: rv</div>
<div class="line">rv = a * gamma(1.0 + 1.0/b);</div>
<div class="line"><span class="keyword">ENDFUNCTION </span>weibull_mean</div>
<div class="line"> </div>
<div class="line"><span class="keyword">FUNCTION </span>weibull_stddev(a, b) <span class="keyword">RESULT</span>(rv)</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line"><span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line">real(c_double), <span class="keywordtype">INTENT(IN)</span> :: a, b</div>
<div class="line">real(c_double) :: rv</div>
<div class="line">rv = a * sqrt(gamma(1.0 + 2.0/b) - gamma(1.0 + 1.0/b)**2)</div>
<div class="line"><span class="keyword">ENDFUNCTION </span>weibull_stddev</div>
<div class="line"> </div>
<div class="line"><span class="keyword">SUBROUTINE </span>test_weibull(rng)</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_fortran_env</div>
<div class="line"><span class="keywordtype">USE </span>:: easyrng</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">TYPE</span> (easy_rng), <span class="keywordtype">INTENT(IN)</span> :: rng</div>
<div class="line"><span class="keywordtype">INTEGER</span> :: i</div>
<div class="line">real(c_double) :: mean, m2, val, delta, stddev</div>
<div class="line">real(c_double), <span class="keywordtype">PARAMETER</span> :: a = 2.0, b = 5.0 </div>
<div class="line"> </div>
<div class="line">mean = 0.0_c_double</div>
<div class="line">m2 = 0.0_c_double</div>
<div class="line"> </div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;Testing easy_ran_weibull&#39;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">DO</span> i=1, nsamples</div>
<div class="line">  val = <a class="code" href="easy__randist_8h.html#a682f3f28ebcc64d3859c00d786b3cdf7">easy_ran_weibull</a>(rng, a, b)</div>
<div class="line">  delta = val - mean</div>
<div class="line">  mean = mean + delta/i</div>
<div class="line">  m2 = m2 + delta * (val - mean)</div>
<div class="line"><span class="keywordflow">ENDDO</span></div>
<div class="line">stddev = sqrt(m2/nsamples)</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      mean: &#39;</span>, mean</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      stddev: &#39;</span>, stddev</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(mean - weibull_mean(a, b)) &lt; 1e-2, __line__)</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(stddev - weibull_stddev(a, b)) &lt; 1.0e-2, __line__)</div>
<div class="line"> </div>
<div class="line"><span class="keyword">ENDSUBROUTINE </span>test_weibull</div>
<div class="line"> </div>
<div class="line"><span class="keyword">SUBROUTINE </span>discrete_mean_stddev(P, mean, stddev)</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line"><span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"> </div>
<div class="line">real(c_double), <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: p</div>
<div class="line">real(c_double), <span class="keywordtype">INTENT(OUT)</span> :: mean, stddev</div>
<div class="line">real(c_double) :: mysum</div>
<div class="line"><span class="keywordtype">INTEGER</span> :: i</div>
<div class="line"> </div>
<div class="line">mean = 0.0</div>
<div class="line">stddev = 0.0</div>
<div class="line">mysum = sum(p)</div>
<div class="line">p = p/mysum</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">DO</span> i=1,<span class="keyword">SIZE</span>(p)</div>
<div class="line">  mean = mean + (i-1) * p(i)</div>
<div class="line"><span class="keywordflow">ENDDO</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">DO</span> i=1,<span class="keyword">SIZE</span>(p)</div>
<div class="line">  stddev = stddev + (i - 1 - mean) * (i -1 - mean) * p(i)</div>
<div class="line"><span class="keywordflow">ENDDO</span></div>
<div class="line"> </div>
<div class="line">stddev = sqrt(stddev)</div>
<div class="line"> </div>
<div class="line"><span class="keyword">ENDSUBROUTINE </span>discrete_mean_stddev</div>
<div class="line"> </div>
<div class="line"><span class="keyword">SUBROUTINE </span>test_discrete(rng)</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_fortran_env</div>
<div class="line"><span class="keywordtype">USE </span>:: easyrng</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">TYPE</span> (easy_rng), <span class="keywordtype">INTENT(IN)</span> :: rng</div>
<div class="line"><span class="keywordtype">INTEGER</span> :: i</div>
<div class="line">real(c_double) :: mean, m2, val, delta, stddev</div>
<div class="line">real(c_double) :: real_mean, real_stddev</div>
<div class="line"><span class="keywordtype">TYPE</span> (easy_ran_discrete_t) :: disc</div>
<div class="line">real(c_double), <span class="keywordtype">DIMENSION(10)</span> :: p = [0.1, 0.2, 0.3, 0.4, 0.5, 0.5, 0.4, 0.3, 0.2, 0.1]</div>
<div class="line"> </div>
<div class="line">mean = 0.0_c_double</div>
<div class="line">m2 = 0.0_c_double</div>
<div class="line"> </div>
<div class="line">disc = <a class="code" href="easy__randist_8h.html#a2e40a7447137fd82a5793eb8ee0fa377">easy_ran_discrete_preproc</a>(p)</div>
<div class="line"> </div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;Testing easy_ran_discrete&#39;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">DO</span> i=1, nsamples</div>
<div class="line">  val = <a class="code" href="easy__randist_8h.html#a28f7c40f264a1d335fa694014e078176">easy_ran_discrete</a>(rng, disc)</div>
<div class="line">  delta = val - mean</div>
<div class="line">  mean = mean + delta/i</div>
<div class="line">  m2 = m2 + delta * (val - mean)</div>
<div class="line"><span class="keywordflow">ENDDO</span></div>
<div class="line">stddev = sqrt(m2/nsamples)</div>
<div class="line"><span class="keyword">CALL </span><a class="code" href="easy__randist_8h.html#a5828774909be2bacc2fb50c4e2815162">easy_ran_discrete_free</a>(disc)</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      mean: &#39;</span>, mean</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      stddev: &#39;</span>, stddev</div>
<div class="line"><span class="keyword">CALL </span>discrete_mean_stddev(p, real_mean, real_stddev)</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(mean - real_mean) &lt; 1e-2, __line__)</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(stddev - real_stddev) &lt; 1.0e-2, __line__)</div>
<div class="line"> </div>
<div class="line"><span class="keyword">ENDSUBROUTINE </span>test_discrete</div>
<div class="line"> </div>
<div class="line"><span class="keyword">SUBROUTINE </span>test_poisson(rng)</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_fortran_env</div>
<div class="line"><span class="keywordtype">USE </span>:: easyrng</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">TYPE</span> (easy_rng), <span class="keywordtype">INTENT(IN)</span> :: rng</div>
<div class="line"><span class="keywordtype">INTEGER</span> :: i</div>
<div class="line">real(c_double) :: mean, m2, val, delta, stddev</div>
<div class="line">real(c_double), <span class="keywordtype">PARAMETER</span> :: mu = 10.0</div>
<div class="line"> </div>
<div class="line">mean = 0.0_c_double</div>
<div class="line">m2 = 0.0_c_double</div>
<div class="line"> </div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;Testing easy_ran_poisson&#39;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">DO</span> i=1, nsamples</div>
<div class="line">  val = <a class="code" href="easy__randist_8h.html#a22e57f0b5a0f69e7c2a6becc1bed6f39">easy_ran_poisson</a>(rng, mu)</div>
<div class="line">  delta = val - mean</div>
<div class="line">  mean = mean + delta/i</div>
<div class="line">  m2 = m2 + delta * (val - mean)</div>
<div class="line"><span class="keywordflow">ENDDO</span></div>
<div class="line">stddev = sqrt(m2/nsamples)</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      mean: &#39;</span>, mean</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      stddev: &#39;</span>, stddev</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(mean - mu) &lt; 1e-2, __line__)</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(stddev - sqrt(mu)) &lt; 1.0e-2, __line__)</div>
<div class="line"> </div>
<div class="line"><span class="keyword">ENDSUBROUTINE </span>test_poisson</div>
<div class="line"> </div>
<div class="line"><span class="keyword">SUBROUTINE </span>test_bernoulli(rng)</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_fortran_env</div>
<div class="line"><span class="keywordtype">USE </span>:: easyrng</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">TYPE</span> (easy_rng), <span class="keywordtype">INTENT(IN)</span> :: rng</div>
<div class="line"><span class="keywordtype">INTEGER</span> :: i</div>
<div class="line">real(c_double) :: mean, m2, val, delta, stddev</div>
<div class="line">real(c_double), <span class="keywordtype">PARAMETER</span> :: mu = 0.25</div>
<div class="line"> </div>
<div class="line">mean = 0.0_c_double</div>
<div class="line">m2 = 0.0_c_double</div>
<div class="line"> </div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;Testing easy_ran_bernoulli&#39;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">DO</span> i=1, nsamples</div>
<div class="line">  val = <a class="code" href="easy__randist_8h.html#a3ad85d4d4937bec2128ef9c1eed7fa0f">easy_ran_bernoulli</a>(rng, mu)</div>
<div class="line">  delta = val - mean</div>
<div class="line">  mean = mean + delta/i</div>
<div class="line">  m2 = m2 + delta * (val - mean)</div>
<div class="line"><span class="keywordflow">ENDDO</span></div>
<div class="line">stddev = sqrt(m2/nsamples)</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      mean: &#39;</span>, mean</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      stddev: &#39;</span>, stddev</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(mean - mu) &lt; 1e-2, __line__)</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(stddev - sqrt(mu * (1.0 - mu))) &lt; 1.0e-2, __line__)</div>
<div class="line"> </div>
<div class="line"><span class="keyword">ENDSUBROUTINE </span>test_bernoulli</div>
<div class="line"> </div>
<div class="line"><span class="keyword">SUBROUTINE </span>test_binomial(rng)</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_fortran_env</div>
<div class="line"><span class="keywordtype">USE </span>:: easyrng</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">TYPE</span> (easy_rng), <span class="keywordtype">INTENT(IN)</span> :: rng</div>
<div class="line"><span class="keywordtype">INTEGER</span> :: i</div>
<div class="line">real(c_double) :: mean, m2, val, delta, stddev</div>
<div class="line">real(c_double), <span class="keywordtype">PARAMETER</span> :: p = 0.25</div>
<div class="line"><span class="keywordtype">INTEGER (C_INT)</span>, <span class="keywordtype">PARAMETER</span> :: n = 25</div>
<div class="line"> </div>
<div class="line">mean = 0.0_c_double</div>
<div class="line">m2 = 0.0_c_double</div>
<div class="line"> </div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;Testing easy_ran_binomial&#39;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">DO</span> i=1, nsamples</div>
<div class="line">  val = <a class="code" href="easy__randist_8h.html#a97a24029f6d8cb779da6237f8dbbd21a">easy_ran_binomial</a>(rng, p, n)</div>
<div class="line">  delta = val - mean</div>
<div class="line">  mean = mean + delta/i</div>
<div class="line">  m2 = m2 + delta * (val - mean)</div>
<div class="line"><span class="keywordflow">ENDDO</span></div>
<div class="line">stddev = sqrt(m2/nsamples)</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      mean: &#39;</span>, mean</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      stddev: &#39;</span>, stddev</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(mean - p * n) &lt; 1e-2, __line__)</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(stddev - sqrt(n * p * (1.0 - p))) &lt; 1.0e-2, __line__)</div>
<div class="line"> </div>
<div class="line"><span class="keyword">ENDSUBROUTINE </span>test_binomial</div>
<div class="line"> </div>
<div class="line"><span class="keyword">SUBROUTINE </span>test_negative_binomial(rng)</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_fortran_env</div>
<div class="line"><span class="keywordtype">USE </span>:: easyrng</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">TYPE</span> (easy_rng), <span class="keywordtype">INTENT(IN)</span> :: rng</div>
<div class="line"><span class="keywordtype">INTEGER</span> :: i</div>
<div class="line">real(c_double) :: mean, m2, val, delta, stddev</div>
<div class="line">real(c_double), <span class="keywordtype">PARAMETER</span> :: p = 0.25</div>
<div class="line"><span class="keywordtype">INTEGER (C_INT)</span>, <span class="keywordtype">PARAMETER</span> :: n = 25</div>
<div class="line"> </div>
<div class="line">mean = 0.0_c_double</div>
<div class="line">m2 = 0.0_c_double</div>
<div class="line"> </div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;Testing easy_ran_negative_binomial&#39;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">DO</span> i=1, nsamples</div>
<div class="line">  val = <a class="code" href="easy__randist_8h.html#ac2f489458487f814d4617b725f86ac3d">easy_ran_negative_binomial</a>(rng, p, n)</div>
<div class="line">  delta = val - mean</div>
<div class="line">  mean = mean + delta/i</div>
<div class="line">  m2 = m2 + delta * (val - mean)</div>
<div class="line"><span class="keywordflow">ENDDO</span></div>
<div class="line">stddev = sqrt(m2/nsamples)</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      mean: &#39;</span>, mean</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      stddev: &#39;</span>, stddev</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(mean - n * (1.0 - p) / p) &lt; 1e-1, __line__)</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(stddev - sqrt(n * (1.0 - p) / p /p)) &lt; 1.0e-1, __line__)</div>
<div class="line"> </div>
<div class="line"><span class="keyword">ENDSUBROUTINE </span>test_negative_binomial</div>
<div class="line"> </div>
<div class="line"><span class="keyword">SUBROUTINE </span>test_geometric(rng)</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_c_binding</div>
<div class="line">use, <span class="keywordtype">INTRINSIC</span> :: iso_fortran_env</div>
<div class="line"><span class="keywordtype">USE </span>:: easyrng</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">TYPE</span> (easy_rng), <span class="keywordtype">INTENT(IN)</span> :: rng</div>
<div class="line"><span class="keywordtype">INTEGER</span> :: i</div>
<div class="line">real(c_double) :: mean, m2, val, delta, stddev</div>
<div class="line">real(c_double), <span class="keywordtype">PARAMETER</span> :: p = 0.25</div>
<div class="line"> </div>
<div class="line">mean = 0.0_c_double</div>
<div class="line">m2 = 0.0_c_double</div>
<div class="line"> </div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&#39;Testing easy_ran_geometric&#39;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">DO</span> i=1, nsamples</div>
<div class="line">  val = <a class="code" href="easy__randist_8h.html#ab0c8ec9c31b1b5dd2fe1261d6515d182">easy_ran_geometric</a>(rng, p)</div>
<div class="line">  delta = val - mean</div>
<div class="line">  mean = mean + delta/i</div>
<div class="line">  m2 = m2 + delta * (val - mean)</div>
<div class="line"><span class="keywordflow">ENDDO</span></div>
<div class="line">stddev = sqrt(m2/nsamples)</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      mean: &#39;</span>, mean</div>
<div class="line"><span class="keyword">WRITE</span> (output_unit, <span class="stringliteral">&#39;(A,ES10.3)&#39;</span>) <span class="stringliteral">&#39;      stddev: &#39;</span>, stddev</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(mean - 1.0 / p) &lt; 1e-2, __line__)</div>
<div class="line"><span class="keyword">CALL </span>assert(abs(stddev - sqrt((1.0 - p) / p / p)) &lt; 1.0e-2, __line__)</div>
<div class="line"> </div>
<div class="line"><span class="keyword">ENDSUBROUTINE </span>test_geometric</div>
<div class="line"><span class="keyword">ENDPROGRAM </span>test6</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="aeasy__rng_8h_html_a42e237e12705f24d1bc9185dd85da87a"><div class="ttname"><a href="easy__rng_8h.html#a42e237e12705f24d1bc9185dd85da87a">easy_rng_equal</a></div><div class="ttdeci">int easy_rng_equal(const easy_rng *ra, const easy_rng *rb)</div></div>
<div class="ttc" id="aeasy__randist_8h_html_a5828774909be2bacc2fb50c4e2815162"><div class="ttname"><a href="easy__randist_8h.html#a5828774909be2bacc2fb50c4e2815162">easy_ran_discrete_free</a></div><div class="ttdeci">void easy_ran_discrete_free(easy_ran_discrete_t *g)</div></div>
<div class="ttc" id="aeasy__randist_8h_html_a3ad85d4d4937bec2128ef9c1eed7fa0f"><div class="ttname"><a href="easy__randist_8h.html#a3ad85d4d4937bec2128ef9c1eed7fa0f">easy_ran_bernoulli</a></div><div class="ttdeci">unsigned int easy_ran_bernoulli(const easy_rng *r, double p)</div></div>
<div class="ttc" id="aeasy__randist_8h_html_ac2f489458487f814d4617b725f86ac3d"><div class="ttname"><a href="easy__randist_8h.html#ac2f489458487f814d4617b725f86ac3d">easy_ran_negative_binomial</a></div><div class="ttdeci">unsigned int easy_ran_negative_binomial(const easy_rng *r, double p, unsigned int n)</div></div>
<div class="ttc" id="aeasy__rng_8h_html_a19d630d55113cfac076a582a6e4863ba"><div class="ttname"><a href="easy__rng_8h.html#a19d630d55113cfac076a582a6e4863ba">easy_rng_free</a></div><div class="ttdeci">void easy_rng_free(easy_rng *r)</div></div>
<div class="ttc" id="aeasy__rng_8h_html_a03a2111e5941ce6a20a210cf6017c13d"><div class="ttname"><a href="easy__rng_8h.html#a03a2111e5941ce6a20a210cf6017c13d">easy_rng_mt19937</a></div><div class="ttdeci">const easy_rng_type * easy_rng_mt19937</div></div>
<div class="ttc" id="aeasy__randist_8h_html_a3ec53a0d47be76d2445daead08f4dd32"><div class="ttname"><a href="easy__randist_8h.html#a3ec53a0d47be76d2445daead08f4dd32">easy_ran_discrete_t</a></div><div class="ttdeci">struct _easy_ran_discrete_t easy_ran_discrete_t</div><div class="ttdef"><b>Definition:</b> easy_randist.h:226</div></div>
<div class="ttc" id="aeasy__rng_8h_html_a6df8544bca640da8fc342b835420372c"><div class="ttname"><a href="easy__rng_8h.html#a6df8544bca640da8fc342b835420372c">easy_rng_get</a></div><div class="ttdeci">unsigned long int easy_rng_get(const easy_rng *r)</div></div>
<div class="ttc" id="aeasy__rng_8h_html_a5662391114b11e8e4941bb6fe2afcc8c"><div class="ttname"><a href="easy__rng_8h.html#a5662391114b11e8e4941bb6fe2afcc8c">easy_rng</a></div><div class="ttdeci">struct _easy_rng easy_rng</div><div class="ttdef"><b>Definition:</b> easy_rng.h:65</div></div>
<div class="ttc" id="aeasy__rng_8h_html_a5721c3419d7f703d74877df274d59a5d"><div class="ttname"><a href="easy__rng_8h.html#a5721c3419d7f703d74877df274d59a5d">easy_rng_clone</a></div><div class="ttdeci">easy_rng * easy_rng_clone(const easy_rng *r)</div></div>
<div class="ttc" id="aeasy__randist_8h_html_a97a24029f6d8cb779da6237f8dbbd21a"><div class="ttname"><a href="easy__randist_8h.html#a97a24029f6d8cb779da6237f8dbbd21a">easy_ran_binomial</a></div><div class="ttdeci">unsigned int easy_ran_binomial(const easy_rng *r, double p, unsigned int n)</div></div>
<div class="ttc" id="aeasy__randist_8h_html_a8e9aa28448987c10b9c11aa9b802a39b"><div class="ttname"><a href="easy__randist_8h.html#a8e9aa28448987c10b9c11aa9b802a39b">easy_ran_fdist</a></div><div class="ttdeci">double easy_ran_fdist(const easy_rng *r, double d_1, double d_2)</div></div>
<div class="ttc" id="aeasy__rng_8h_html_a4cde3fe49fdd3a78826ffcc3a440c5b6"><div class="ttname"><a href="easy__rng_8h.html#a4cde3fe49fdd3a78826ffcc3a440c5b6">easy_rng_set</a></div><div class="ttdeci">void easy_rng_set(const easy_rng *r, unsigned long int s)</div></div>
<div class="ttc" id="aeasy__randist_8h_html_a8ac93416e4da2d0429ac109e6cc234e8"><div class="ttname"><a href="easy__randist_8h.html#a8ac93416e4da2d0429ac109e6cc234e8">easy_ran_ugaussian</a></div><div class="ttdeci">double easy_ran_ugaussian(const easy_rng *r)</div></div>
<div class="ttc" id="aeasy__randist_8h_html_a22e57f0b5a0f69e7c2a6becc1bed6f39"><div class="ttname"><a href="easy__randist_8h.html#a22e57f0b5a0f69e7c2a6becc1bed6f39">easy_ran_poisson</a></div><div class="ttdeci">unsigned int easy_ran_poisson(const easy_rng *r, double lambda)</div></div>
<div class="ttc" id="aeasy__randist_8h_html_a04c98539c263989a99dae4457e6ac361"><div class="ttname"><a href="easy__randist_8h.html#a04c98539c263989a99dae4457e6ac361">easy_ran_flat</a></div><div class="ttdeci">double easy_ran_flat(const easy_rng *r, double a, double b)</div></div>
<div class="ttc" id="aeasy__rng_8h_html_structeasy__rng__type"><div class="ttname"><a href="easy__rng_8h.html#structeasy__rng__type">easy_rng_type</a></div><div class="ttdef"><b>Definition:</b> easy_rng.h:71</div></div>
<div class="ttc" id="aeasy__rng_8h_html_abb81d00f216d1c72cc7a4faee4839ac9"><div class="ttname"><a href="easy__rng_8h.html#abb81d00f216d1c72cc7a4faee4839ac9">easy_rng_uniform_pos</a></div><div class="ttdeci">double easy_rng_uniform_pos(const easy_rng *r)</div></div>
<div class="ttc" id="aeasy__randist_8h_html_ab0c8ec9c31b1b5dd2fe1261d6515d182"><div class="ttname"><a href="easy__randist_8h.html#ab0c8ec9c31b1b5dd2fe1261d6515d182">easy_ran_geometric</a></div><div class="ttdeci">unsigned int easy_ran_geometric(const easy_rng *r, double p)</div></div>
<div class="ttc" id="aeasy__rng_8h_html_a92de1f25f208a2348302558c91269def"><div class="ttname"><a href="easy__rng_8h.html#a92de1f25f208a2348302558c91269def">easy_rng_fwrite</a></div><div class="ttdeci">int easy_rng_fwrite(FILE *stream, const easy_rng *r)</div></div>
<div class="ttc" id="aeasy__randist_8h_html"><div class="ttname"><a href="easy__randist_8h.html">easy_randist.h</a></div><div class="ttdoc">The random number distributions API.</div></div>
<div class="ttc" id="aeasy__rng_8h_html"><div class="ttname"><a href="easy__rng_8h.html">easy_rng.h</a></div><div class="ttdoc">The random number generator API.</div></div>
<div class="ttc" id="aeasy__rng_8h_html_a1d59580b57d8241e420d989afc3cf226"><div class="ttname"><a href="easy__rng_8h.html#a1d59580b57d8241e420d989afc3cf226">easy_rng_uniform</a></div><div class="ttdeci">double easy_rng_uniform(const easy_rng *r)</div></div>
<div class="ttc" id="aeasy__rng_8h_html_a7982b751eb13a826381c606b222efeaa"><div class="ttname"><a href="easy__rng_8h.html#a7982b751eb13a826381c606b222efeaa">easy_rng_minstd_rand</a></div><div class="ttdeci">const easy_rng_type * easy_rng_minstd_rand</div></div>
<div class="ttc" id="aeasy__rng_8h_html_a48ab27e3436e334bacfe4552c77a8293"><div class="ttname"><a href="easy__rng_8h.html#a48ab27e3436e334bacfe4552c77a8293">easy_rng_types_setup</a></div><div class="ttdeci">const easy_rng_type ** easy_rng_types_setup(void)</div></div>
<div class="ttc" id="aeasy__randist_8h_html_a682f3f28ebcc64d3859c00d786b3cdf7"><div class="ttname"><a href="easy__randist_8h.html#a682f3f28ebcc64d3859c00d786b3cdf7">easy_ran_weibull</a></div><div class="ttdeci">double easy_ran_weibull(const easy_rng *r, double lambda, double k)</div></div>
<div class="ttc" id="aeasy__randist_8h_html_aa2ddd4ffca96f5a5700c700a8091fc6d"><div class="ttname"><a href="easy__randist_8h.html#aa2ddd4ffca96f5a5700c700a8091fc6d">easy_ran_exponential</a></div><div class="ttdeci">double easy_ran_exponential(const easy_rng *r, double mu)</div></div>
<div class="ttc" id="aeasy__randist_8h_html_aa73ac6dbe5840c804b3419926ee72641"><div class="ttname"><a href="easy__randist_8h.html#aa73ac6dbe5840c804b3419926ee72641">easy_ran_gaussian</a></div><div class="ttdeci">double easy_ran_gaussian(const easy_rng *r, double sigma)</div></div>
<div class="ttc" id="aeasy__randist_8h_html_a28f7c40f264a1d335fa694014e078176"><div class="ttname"><a href="easy__randist_8h.html#a28f7c40f264a1d335fa694014e078176">easy_ran_discrete</a></div><div class="ttdeci">size_t easy_ran_discrete(const easy_rng *r, const easy_ran_discrete_t *g)</div></div>
<div class="ttc" id="aeasy__randist_8h_html_aa58eb8b44c683e0852e406bf0e7abcc1"><div class="ttname"><a href="easy__randist_8h.html#aa58eb8b44c683e0852e406bf0e7abcc1">easy_ran_gamma</a></div><div class="ttdeci">double easy_ran_gamma(const easy_rng *r, double k, double theta)</div></div>
<div class="ttc" id="aeasy__randist_8h_html_a2e40a7447137fd82a5793eb8ee0fa377"><div class="ttname"><a href="easy__randist_8h.html#a2e40a7447137fd82a5793eb8ee0fa377">easy_ran_discrete_preproc</a></div><div class="ttdeci">easy_ran_discrete_t * easy_ran_discrete_preproc(size_t K, const double *P)</div></div>
<div class="ttc" id="aeasy__rng_8h_html_a9c686db435b2ca790404ffa0731ce324"><div class="ttname"><a href="easy__rng_8h.html#a9c686db435b2ca790404ffa0731ce324">easy_rng_ranlux24</a></div><div class="ttdeci">const easy_rng_type * easy_rng_ranlux24</div></div>
<div class="ttc" id="aeasy__rng_8h_html_a2618c95894efe0d6b874ad37e7853a0e"><div class="ttname"><a href="easy__rng_8h.html#a2618c95894efe0d6b874ad37e7853a0e">easy_rng_ranlux48</a></div><div class="ttdeci">const easy_rng_type * easy_rng_ranlux48</div></div>
<div class="ttc" id="aeasy__rng_8h_html_ae10e10fb6573d977a7b7fdd89000ce02"><div class="ttname"><a href="easy__rng_8h.html#ae10e10fb6573d977a7b7fdd89000ce02">easy_rng_max</a></div><div class="ttdeci">unsigned long int easy_rng_max(const easy_rng *r)</div></div>
<div class="ttc" id="aeasy__rng_8h_html_a20307b97d36836c046d57794ee241174"><div class="ttname"><a href="easy__rng_8h.html#a20307b97d36836c046d57794ee241174">easy_rng_uniform_int</a></div><div class="ttdeci">unsigned long int easy_rng_uniform_int(const easy_rng *r, unsigned long int n)</div></div>
<div class="ttc" id="aeasy__randist_8h_html_a8dda25bf957f749bf12974701984529e"><div class="ttname"><a href="easy__randist_8h.html#a8dda25bf957f749bf12974701984529e">easy_ran_tdist</a></div><div class="ttdeci">double easy_ran_tdist(const easy_rng *r, double nu)</div></div>
<div class="ttc" id="aeasy__randist_8h_html_acff3c5fc0e1788a0e0f312b11614cd08"><div class="ttname"><a href="easy__randist_8h.html#acff3c5fc0e1788a0e0f312b11614cd08">easy_ran_lognormal</a></div><div class="ttdeci">double easy_ran_lognormal(const easy_rng *r, double mu, double sigma)</div></div>
<div class="ttc" id="aeasy__rng_8h_html_a34837a567a02ed025cc5230cafcfa30a"><div class="ttname"><a href="easy__rng_8h.html#a34837a567a02ed025cc5230cafcfa30a">easy_rng_alloc</a></div><div class="ttdeci">easy_rng * easy_rng_alloc(const easy_rng_type *T)</div></div>
<div class="ttc" id="aeasy__rng_8h_html_a5283493f3e6510dc16ea6243a3064cc8"><div class="ttname"><a href="easy__rng_8h.html#a5283493f3e6510dc16ea6243a3064cc8">easy_rng_name</a></div><div class="ttdeci">const char * easy_rng_name(const easy_rng *r)</div></div>
<div class="ttc" id="aeasy__rng_8h_html_a36c2cefe628eb42943d5d44ef41c4c53"><div class="ttname"><a href="easy__rng_8h.html#a36c2cefe628eb42943d5d44ef41c4c53">easy_rng_minstd_rand0</a></div><div class="ttdeci">const easy_rng_type * easy_rng_minstd_rand0</div></div>
<div class="ttc" id="aeasy__rng_8h_html_a31a7405b674cffe3dacd0f044dddc3c1"><div class="ttname"><a href="easy__rng_8h.html#a31a7405b674cffe3dacd0f044dddc3c1">easy_rng_fread</a></div><div class="ttdeci">int easy_rng_fread(FILE *stream, easy_rng *r)</div></div>
<div class="ttc" id="aeasy__rng_8h_html_ab7ebef8f2b34c0e623a67558ecc7aff8"><div class="ttname"><a href="easy__rng_8h.html#ab7ebef8f2b34c0e623a67558ecc7aff8">easy_rng_min</a></div><div class="ttdeci">unsigned long int easy_rng_min(const easy_rng *r)</div></div>
<div class="ttc" id="aeasy__randist_8h_html_ae5338d2afbcfbd97e6a130d485c2fc1b"><div class="ttname"><a href="easy__randist_8h.html#ae5338d2afbcfbd97e6a130d485c2fc1b">easy_ran_chisq</a></div><div class="ttdeci">double easy_ran_chisq(const easy_rng *r, double k)</div></div>
<div class="ttc" id="aeasy__rng_8h_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="easy__rng_8h.html#a8f8f80d37794cde9472343e4487ba3eb">easy_rng_type::name</a></div><div class="ttdeci">const char * name</div><div class="ttdoc">The name of the random number generate type, as a string.</div><div class="ttdef"><b>Definition:</b> easy_rng.h:72</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.18
</small></address>
</body>
</html>
